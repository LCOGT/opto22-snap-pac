
\ ********************** PER File **********************

?EXISTS DL.STAT SWAP DROP .IF 1 DL.STAT .THEN
_END NEW $$$.RUN FORGET $$$.RUN
GetPersistentTop  **ipac**
-2147483648 FVAR ^PidSetpoint
PersistentMAKECHECK

\ ********************** CRN File **********************

_END NEW $$$.RUN
: FILENAME  ." ipac " ;
1 0 $VAR *_HSV_SEMA 
1024 0 $VAR *_HSV_TEMP 
200 0 $VAR *_HSV_INIT_IO 
0 IVAR ^_HNV_INIT_IO 

\   ++++++++++ SUB name="O22Modbus03ReadHoldingRegistersAsInt" ++++++++++

0 SUBR &O22Modbus03ReadHoldingRegistersAsInt
SUB.CODE nullIVAR nullILiteral nullITABLE nullILiteral nullILiteral nullITABLE nullCOMVAR &O22Modbus03ReadHoldingRegistersAsInt
0 TVAR ^dtWait_Timer
0 FVAR ^fWaitTime
0 IVAR ^nIndex
0 IVAR ^nIntegerType
0 IVAR ^nNumReturnValues
0 IVAR ^nReceive_Index
0 IVAR ^nStart_Index
0 IVAR ^nStartRegisterNumber
0 IVAR ^nTemp1
0 IVAR ^nTemp2
512 0 $VAR *sTempString1 
512 0 $VAR *sTempString2 
4 0 $VAR *sTempString3 
1024 0 COMVAR *chCommHandle 
261 0 ITABLE }ntReceive_Table

: &O22Modbus03ReadHoldingRegistersAsInt.0
0 JUMP ;
: &O22Modbus03ReadHoldingRegistersAsInt.3
1 LINE.NUM 6 PARAM  ?STREAM.KEY 0 < IF 
2 LINE.NUM 6 PARAM  OPEN 0 PARAM @! 
3 LINE.NUM ELSE 
4 LINE.NUM 0 0 PARAM @! 
5 LINE.NUM THEN 
10 JUMP ;
: &O22Modbus03ReadHoldingRegistersAsInt.10
16 JUMP ;
: &O22Modbus03ReadHoldingRegistersAsInt.22
1 LINE.NUM 5 5 PARAM TABLE@ 65535 MOD  5 5 PARAM TABLE! 
2 LINE.NUM 5 5 PARAM TABLE@ 1 +  5 5 PARAM TABLE! 
5 LINE.NUM 5 5 PARAM TABLE@ 65280 AND  8 -1 *  SHIFT  ^nTemp1 @! 
6 LINE.NUM " " *sTempString1 $MOVE ^nTemp1 @@ *sTempString1  $APPEND 
7 LINE.NUM 5 5 PARAM TABLE@ 255 AND  ^nTemp1 @! 
8 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

11 LINE.NUM 0 *sTempString1 $APPEND 

12 LINE.NUM 0 *sTempString1 $APPEND 

15 LINE.NUM 0 *sTempString1 $APPEND 

16 LINE.NUM 6 *sTempString1 $APPEND 

19 LINE.NUM 1 5 PARAM TABLE@ ^nTemp1 @! 
20 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

23 LINE.NUM 3 *sTempString1 $APPEND 

26 LINE.NUM ^nStartRegisterNumber @@ 1 -  65280 AND  8 -1 *  SHIFT  ^nTemp1 @! 
27 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

28 LINE.NUM ^nStartRegisterNumber @@ 1 -  255 AND  ^nTemp1 @! 
29 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

32 LINE.NUM ^nIntegerType @@ 4 = IF 
33 LINE.NUM ^nNumReturnValues @@ 2 *  65280 AND  8 -1 *  SHIFT  ^nTemp1 @! 
34 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

35 LINE.NUM ^nNumReturnValues @@ 2 *  255 AND  ^nTemp1 @! 
36 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

37 LINE.NUM ELSE 
38 LINE.NUM ^nNumReturnValues @@ 65280 AND  8 -1 *  SHIFT  ^nTemp1 @! 
39 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

40 LINE.NUM ^nNumReturnValues @@ 255 AND  ^nTemp1 @! 
41 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

42 LINE.NUM THEN 
0 JUMP ;
: &O22Modbus03ReadHoldingRegistersAsInt.24
1 LINE.NUM *sTempString1 6 PARAM  PRT$ 0 PARAM @! 
2 LINE.NUM 2 5 PARAM TABLE@F ^fWaitTime @! 
3 LINE.NUM ^fWaitTime @@ 1000 I>F F/ ^dtWait_Timer @! 
1 JUMP ;
: &O22Modbus03ReadHoldingRegistersAsInt.28
1 LINE.NUM -216 0 PARAM @! 
13 JUMP ;
: &O22Modbus03ReadHoldingRegistersAsInt.36

1 LINE.NUM
  6 PARAM   ?STREAM.KEY
  ^nTemp1 @! 
10 JUMP ;
: &O22Modbus03ReadHoldingRegistersAsInt.41
1 LINE.NUM 0 5 PARAM TABLE@ CASE 
2 LINE.NUM 0 OF 
3 LINE.NUM *sTempString2 3 6 PARAM  GETN$ DROP  
5 LINE.NUM 3 *sTempString2 1  $INDEX <> IF 
6 LINE.NUM *sTempString2 2  $INDEX 0 PARAM @! 
7 LINE.NUM 6 PARAM  STREAM.CLEAR.BUF 
8 LINE.NUM ELSE 
9 LINE.NUM *sTempString1 *sTempString2 2  $INDEX 6 PARAM  GETN$ DROP  
10 LINE.NUM *sTempString1 *sTempString2 $CAT 

11 LINE.NUM -1 *sTempString2  CalcCRCR ^nTemp2 @! 
12 LINE.NUM *sTempString1 2 6 PARAM  GETN$ DROP  
13 LINE.NUM ^nTemp2 @@ *sTempString1 1  $INDEX 8 SHIFT  *sTempString1 0  $INDEX +  <> IF 
14 LINE.NUM -211 0 PARAM @! 
15 LINE.NUM THEN 
16 LINE.NUM THEN 
17 LINE.NUM ENDOF 
18 LINE.NUM 2 OF 
19 LINE.NUM *sTempString1 6 6 PARAM  GETN$ DROP  
20 LINE.NUM *sTempString2 *sTempString1 4  $INDEX 8 SHIFT  *sTempString1 5  $INDEX +  6 PARAM  GETN$ DROP  
22 LINE.NUM 3 *sTempString2 1  $INDEX <> IF 
23 LINE.NUM *sTempString2 2  $INDEX 0 PARAM @! 
24 LINE.NUM 6 PARAM  STREAM.CLEAR.BUF 
25 LINE.NUM THEN 
26 LINE.NUM ENDOF 
28 LINE.NUM ^nTemp2  FALSE@! 
29 LINE.NUM *sTempString2 6 PARAM  GET$ 0 PARAM @! 
30 LINE.NUM 0 PARAM @@ 0 = IF 
31 LINE.NUM *sTempString2 1 2 *sTempString3  $SUB 
32 LINE.NUM *sTempString3  HEX$>I ^nTemp1 @! 
33 LINE.NUM ^nTemp2 @@ ^nTemp1 @@ +  ^nTemp2 @! 
35 LINE.NUM *sTempString2 3 2 *sTempString3  $SUB 
36 LINE.NUM *sTempString3  HEX$>I ^nTemp1 @! 
37 LINE.NUM ^nTemp2 @@ ^nTemp1 @@ +  ^nTemp2 @! 
39 LINE.NUM 3 ^nTemp1 @@ <> IF 
40 LINE.NUM *sTempString2 5 2 *sTempString3  $SUB 
41 LINE.NUM *sTempString3  HEX$>I 0 PARAM @! 
42 LINE.NUM 6 PARAM  STREAM.CLEAR.BUF 
43 LINE.NUM ELSE 
45 LINE.NUM *sTempString2 5 2 *sTempString3  $SUB 
46 LINE.NUM *sTempString3  HEX$>I ^nTemp1 @! 
47 LINE.NUM ^nTemp2 @@ ^nTemp1 @@ +  ^nTemp2 @! 
48 LINE.NUM 2 ^nReceive_Index @! 
49 LINE.NUM ^nTemp1 @@ ^nReceive_Index @@ }ntReceive_Table TABLE! 
50 LINE.NUM ^nReceive_Index  1+@! 
2 51 LINE.NUM ^nTemp1 @@ 2 *  5 +  1 + 7 DO? I ^nIndex @! 
52 LINE.NUM *sTempString2 ^nIndex @@ 2 *sTempString3  $SUB 
53 LINE.NUM *sTempString3  HEX$>I ^nTemp1 @! 
54 LINE.NUM ^nTemp2 @@ ^nTemp1 @@ +  ^nTemp2 @! 
55 LINE.NUM ^nTemp1 @@ ^nReceive_Index @@ }ntReceive_Table TABLE! 
56 LINE.NUM ^nReceive_Index  1+@! 
57 LINE.NUM 2 +LOOP 
58 LINE.NUM BEGIN ^nTemp2 @@ 255 > WHILE 
59 LINE.NUM ^nTemp2 @@ 256 -  ^nTemp2 @! 
60 LINE.NUM REPEAT 
61 LINE.NUM ^nTemp2 @@ 0 = IF 
62 LINE.NUM 0 ^nTemp1 @! 
63 LINE.NUM ELSE 
64 LINE.NUM 255 ^nTemp2 @@ -  1 +  ^nTemp1 @! 
65 LINE.NUM THEN 
66 LINE.NUM ^nTemp1 @@ 2 *sTempString1  I>HEX$.R 
67 LINE.NUM *sTempString2 ^nIndex @@ 2 +  2 *sTempString3  $SUB 
68 LINE.NUM *sTempString1 *sTempString3 $= LNOT  IF 
69 LINE.NUM -213 0 PARAM @! 
70 LINE.NUM THEN 
71 LINE.NUM THEN 
72 LINE.NUM THEN 
74 LINE.NUM ENDCASE 
10 JUMP ;
: &O22Modbus03ReadHoldingRegistersAsInt.45
10 JUMP ;
: &O22Modbus03ReadHoldingRegistersAsInt.47
1 LINE.NUM 0 5 PARAM TABLE@ 1 = IF 
3 LINE.NUM 2 }ntReceive_Table TABLE@ 2 +  ^nTemp1 @! 
4 LINE.NUM ^nIntegerType @@ CASE 
5 LINE.NUM 0 OF 
2 6 LINE.NUM ^nTemp1 @@ 1 + 3 DO? I ^nIndex @! 
7 LINE.NUM ^nIndex @@ }ntReceive_Table TABLE@ 8 SHIFT  ^nIndex @@ 1 +  }ntReceive_Table TABLE@ +  ^nStart_Index @@ 2 PARAM TABLE! 
8 LINE.NUM ^nStart_Index  1+@! 
9 LINE.NUM 2 +LOOP 
10 LINE.NUM ENDOF 
11 LINE.NUM 1 OF 
2 12 LINE.NUM ^nTemp1 @@ 1 + 3 DO? I ^nIndex @! 
13 LINE.NUM ^nIndex @@ }ntReceive_Table TABLE@ 8 SHIFT  ^nIndex @@ 1 +  }ntReceive_Table TABLE@ +  ^nTemp2 @! 
14 LINE.NUM ^nTemp2 @@ 32767 > IF 
15 LINE.NUM ^nTemp2 @@ 65536 -  ^nStart_Index @@ 2 PARAM TABLE! 
16 LINE.NUM ELSE 
17 LINE.NUM ^nTemp2 @@ ^nStart_Index @@ 2 PARAM TABLE! 
18 LINE.NUM THEN 
19 LINE.NUM ^nStart_Index  1+@! 
20 LINE.NUM 2 +LOOP 
21 LINE.NUM ENDOF 
23 LINE.NUM 3 5 PARAM TABLE@ IF 
4 24 LINE.NUM ^nTemp1 @@ 1 + 3 DO? I ^nIndex @! 
25 LINE.NUM ^nIndex @@ }ntReceive_Table TABLE@ 24 SHIFT  ^nIndex @@ 1 +  }ntReceive_Table TABLE@ 16 SHIFT  +  ^nIndex @@ 2 +  }ntReceive_Table TABLE@ 8 SHIFT  +  ^nIndex @@ 3 +  }ntReceive_Table TABLE@ +  ^nStart_Index @@ 2 PARAM TABLE! 
27 LINE.NUM ^nStart_Index  1+@! 
28 LINE.NUM 4 +LOOP 
29 LINE.NUM ELSE 
4 30 LINE.NUM ^nTemp1 @@ 1 + 3 DO? I ^nIndex @! 
31 LINE.NUM ^nIndex @@ 2 +  }ntReceive_Table TABLE@ 24 SHIFT  ^nIndex @@ 3 +  }ntReceive_Table TABLE@ 16 SHIFT  +  ^nIndex @@ }ntReceive_Table TABLE@ 8 SHIFT  +  ^nIndex @@ 1 +  }ntReceive_Table TABLE@ +  ^nStart_Index @@ 2 PARAM TABLE! 
33 LINE.NUM ^nStart_Index  1+@! 
34 LINE.NUM 4 +LOOP 
35 LINE.NUM THEN 
37 LINE.NUM ENDCASE 
38 LINE.NUM ELSE 
40 LINE.NUM *sTempString2 2  $INDEX ^nTemp1 @! 
41 LINE.NUM ^nIntegerType @@ CASE 
42 LINE.NUM 0 OF 
2 43 LINE.NUM ^nTemp1 @@ 2 +  1 + 3 DO? I ^nIndex @! 
44 LINE.NUM *sTempString2 ^nIndex @@  $INDEX 8 SHIFT  *sTempString2 ^nIndex @@ 1 +   $INDEX OR  ^nStart_Index @@ 2 PARAM TABLE! 
45 LINE.NUM ^nStart_Index  1+@! 
46 LINE.NUM 2 +LOOP 
47 LINE.NUM ENDOF 
48 LINE.NUM 1 OF 
2 49 LINE.NUM ^nTemp1 @@ 2 +  1 + 3 DO? I ^nIndex @! 
50 LINE.NUM *sTempString2 ^nIndex @@  $INDEX 8 SHIFT  *sTempString2 ^nIndex @@ 1 +   $INDEX OR  ^nTemp2 @! 
51 LINE.NUM ^nTemp2 @@ 32767 > IF 
52 LINE.NUM ^nTemp2 @@ 65536 -  ^nStart_Index @@ 2 PARAM TABLE! 
53 LINE.NUM ELSE 
54 LINE.NUM ^nTemp2 @@ ^nStart_Index @@ 2 PARAM TABLE! 
55 LINE.NUM THEN 
56 LINE.NUM ^nStart_Index  1+@! 
57 LINE.NUM 2 +LOOP 
58 LINE.NUM ENDOF 
60 LINE.NUM 3 5 PARAM TABLE@ IF 
4 61 LINE.NUM ^nTemp1 @@ 1 + 3 DO? I ^nIndex @! 
62 LINE.NUM *sTempString2 ^nIndex @@  $INDEX 24 SHIFT  *sTempString2 ^nIndex @@ 1 +   $INDEX 16 SHIFT  OR  *sTempString2 ^nIndex @@ 2 +   $INDEX 8 SHIFT  OR  *sTempString2 ^nIndex @@ 3 +   $INDEX OR  ^nStart_Index @@ 2 PARAM TABLE! 
65 LINE.NUM ^nStart_Index  1+@! 
66 LINE.NUM 4 +LOOP 
67 LINE.NUM ELSE 
4 68 LINE.NUM ^nTemp1 @@ 1 + 3 DO? I ^nIndex @! 
69 LINE.NUM *sTempString2 ^nIndex @@ 2 +   $INDEX 24 SHIFT  *sTempString2 ^nIndex @@ 3 +   $INDEX 16 SHIFT  OR  *sTempString2 ^nIndex @@  $INDEX 8 SHIFT  OR  *sTempString2 ^nIndex @@ 1 +   $INDEX OR  ^nStart_Index @@ 2 PARAM TABLE! 
73 LINE.NUM ^nStart_Index  1+@! 
74 LINE.NUM 4 +LOOP 
75 LINE.NUM THEN 
77 LINE.NUM ENDCASE 
78 LINE.NUM THEN 
9 JUMP ;
: &O22Modbus03ReadHoldingRegistersAsInt.49
2 LINE.NUM 1 5 PARAM TABLE@ ^nTemp1 @! 
3 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

6 LINE.NUM 3 *sTempString1 $APPEND 

9 LINE.NUM ^nStartRegisterNumber @@ 1 -  65280 AND  8 -1 *  SHIFT  ^nTemp1 @! 
10 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

11 LINE.NUM ^nStartRegisterNumber @@ 1 -  255 AND  ^nTemp1 @! 
12 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

15 LINE.NUM ^nIntegerType @@ 4 = IF 
16 LINE.NUM ^nNumReturnValues @@ 2 *  65280 AND  8 -1 *  SHIFT  ^nTemp1 @! 
17 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

18 LINE.NUM ^nNumReturnValues @@ 2 *  255 AND  ^nTemp1 @! 
19 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

20 LINE.NUM ELSE 
21 LINE.NUM ^nNumReturnValues @@ 65280 AND  8 -1 *  SHIFT  ^nTemp1 @! 
22 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

23 LINE.NUM ^nNumReturnValues @@ 255 AND  ^nTemp1 @! 
24 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

25 LINE.NUM THEN 
28 LINE.NUM -1 *sTempString1  CalcCRCR ^nTemp2 @! 
30 LINE.NUM ^nTemp2 @@ 255 AND  ^nTemp1 @! 
31 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

32 LINE.NUM ^nTemp2 @@ 65280 AND  8 -1 *  SHIFT  ^nTemp1 @! 
33 LINE.NUM ^nTemp1 @@ *sTempString1 $APPEND 

-7 JUMP ;
: &O22Modbus03ReadHoldingRegistersAsInt.54
2 LINE.NUM " :" *sTempString1  $MOVE 
5 LINE.NUM 1 5 PARAM TABLE@ 2 *sTempString3  I>HEX$.R 
6 LINE.NUM *sTempString3 *sTempString1 $CAT 

7 LINE.NUM ^nTemp1 @@ 1 5 PARAM TABLE@ +  ^nTemp1 @! 
10 LINE.NUM " 03" *sTempString1 $CAT 

11 LINE.NUM ^nTemp1 @@ 3 +  ^nTemp1 @! 
14 LINE.NUM ^nStartRegisterNumber @@ 1 -  4 *sTempString3  I>HEX$.R 
15 LINE.NUM *sTempString3 *sTempString1 $CAT 

16 LINE.NUM ^nTemp1 @@ ^nStartRegisterNumber @@ 1 -  65280 AND  8 -1 *  SHIFT  +  ^nTemp1 @! 
17 LINE.NUM ^nTemp1 @@ ^nStartRegisterNumber @@ 1 -  255 AND  +  ^nTemp1 @! 
20 LINE.NUM ^nIntegerType @@ 4 = IF 
21 LINE.NUM ^nNumReturnValues @@ 2 *  4 *sTempString3  I>HEX$.R 
22 LINE.NUM *sTempString3 *sTempString1 $CAT 

23 LINE.NUM ^nTemp1 @@ ^nNumReturnValues @@ 2 *  65280 AND  8 -1 *  SHIFT  +  ^nTemp1 @! 
24 LINE.NUM ^nTemp1 @@ ^nNumReturnValues @@ 2 *  255 AND  +  ^nTemp1 @! 
25 LINE.NUM ELSE 
26 LINE.NUM ^nNumReturnValues @@ 4 *sTempString3  I>HEX$.R 
27 LINE.NUM *sTempString3 *sTempString1 $CAT 

28 LINE.NUM ^nTemp1 @@ ^nNumReturnValues @@ 65280 AND  8 -1 *  SHIFT  +  ^nTemp1 @! 
29 LINE.NUM ^nTemp1 @@ ^nNumReturnValues @@ 255 AND  +  ^nTemp1 @! 
30 LINE.NUM THEN 
35 LINE.NUM BEGIN ^nTemp1 @@ 255 > WHILE 
36 LINE.NUM ^nTemp1 @@ 256 -  ^nTemp1 @! 
37 LINE.NUM REPEAT 
38 LINE.NUM ^nTemp1 @@ 0 = IF 
39 LINE.NUM 0 ^nTemp2 @! 
40 LINE.NUM ELSE 
41 LINE.NUM 255 ^nTemp1 @@ -  1 +  ^nTemp2 @! 
42 LINE.NUM THEN 
44 LINE.NUM ^nTemp2 @@ 2 *sTempString3  I>HEX$.R 
45 LINE.NUM *sTempString3 *sTempString1 $CAT 

48 LINE.NUM 13 *sTempString1 $APPEND 

49 LINE.NUM 10 *sTempString1 $APPEND 

53 LINE.NUM 6 PARAM 10  S.!EOL 
-8 JUMP ;
: &O22Modbus03ReadHoldingRegistersAsInt.4
FALSE

1 LINE.NUM
  0 PARAM @@ 
  0    =
LOR

2 LINE.NUM
  0 PARAM @@ 
  -47    =
LOR
IF 1 JUMP ELSE -11 JUMP THEN ;
: &O22Modbus03ReadHoldingRegistersAsInt.17
TRUE

1 LINE.NUM
  0  
  0  
  5 PARAM TABLE@   =
LAND
IF -4 JUMP ELSE -3 JUMP THEN ;
: &O22Modbus03ReadHoldingRegistersAsInt.18
TRUE

1 LINE.NUM
  2  
  0  
  5 PARAM TABLE@   =
LAND
IF -12 JUMP ELSE -2 JUMP THEN ;
: &O22Modbus03ReadHoldingRegistersAsInt.33
TRUE

1 LINE.NUM
  ^nTemp1 @@ 
  0    <
LAND
IF -11 JUMP ELSE -10 JUMP THEN ;
: &O22Modbus03ReadHoldingRegistersAsInt.34
TRUE

1 LINE.NUM
  ^dtWait_Timer   T0=
LAND
IF -12 JUMP ELSE -2 JUMP THEN ;
: &O22Modbus03ReadHoldingRegistersAsInt.35
TRUE

1 LINE.NUM
  ^nTemp1 @@ 
  5    >=
LAND
IF -11 JUMP ELSE -2 JUMP THEN ;
: &O22Modbus03ReadHoldingRegistersAsInt.43
TRUE

1 LINE.NUM
  0 PARAM @@ 
  0    =
LAND
IF -10 JUMP ELSE -11 JUMP THEN ;

CODE
4 PARAM @@ ^nIntegerType @! 
3 PARAM @@ ^nStartRegisterNumber @! 
1 PARAM @@ ^nNumReturnValues @! 

DUMMY
&O22Modbus03ReadHoldingRegistersAsInt.0
&O22Modbus03ReadHoldingRegistersAsInt.3
&O22Modbus03ReadHoldingRegistersAsInt.10
&O22Modbus03ReadHoldingRegistersAsInt.22
&O22Modbus03ReadHoldingRegistersAsInt.24
&O22Modbus03ReadHoldingRegistersAsInt.28
&O22Modbus03ReadHoldingRegistersAsInt.36
&O22Modbus03ReadHoldingRegistersAsInt.41
&O22Modbus03ReadHoldingRegistersAsInt.45
&O22Modbus03ReadHoldingRegistersAsInt.47
&O22Modbus03ReadHoldingRegistersAsInt.49
&O22Modbus03ReadHoldingRegistersAsInt.54
&O22Modbus03ReadHoldingRegistersAsInt.4
&O22Modbus03ReadHoldingRegistersAsInt.17
&O22Modbus03ReadHoldingRegistersAsInt.18
&O22Modbus03ReadHoldingRegistersAsInt.33
&O22Modbus03ReadHoldingRegistersAsInt.34
&O22Modbus03ReadHoldingRegistersAsInt.35
&O22Modbus03ReadHoldingRegistersAsInt.43
ENDCODE

\   ++++++++++ SUB name="Timestamp" ++++++++++

0 SUBR &Timestamp
SUB.CODE null$VAR &Timestamp
0 IVAR ^nCounter
15 0 $VAR *sDate 
10 0 $VAR *sTimeString 
8 0 ITABLE }nDateTimeArray
8 10 0 $TABLE {sDateTimeArray

: &Timestamp.0
0 JUMP ;
: &Timestamp.2
4 LINE.NUM " " 0 PARAM  $MOVE 
5 LINE.NUM *sDate  0 DATE>$ 
6 LINE.NUM *sDate 6 4 0 PARAM  $SUB 
7 LINE.NUM " /" 0 PARAM $CAT 

8 LINE.NUM *sDate 0 5 *sDate  $SUB 
9 LINE.NUM *sDate 0 PARAM $CAT 

10 LINE.NUM " T" 0 PARAM $CAT 

11 LINE.NUM *sTimeString  TIME>$ 
12 LINE.NUM *sTimeString 0 PARAM $CAT 

0 JUMP ;

CODE

DUMMY
&Timestamp.0
&Timestamp.2
ENDCODE
0 TASK  &_INIT_IO
0 TASK &DatatakerComm
0 TASK &GoogleComm
0 TASK &Housekeeper
0 TASK &MasterComm
0 TASK &Modbus_Master
0 TASK &Powerup
0 IVAR ^AirCon_CR_ErrorFlag
0 IVAR ^AirConOffFlag
0 IVAR ^Bitmask
0 FVAR ^CalcFanSpd
0 IVAR ^Count
0 IVAR ^Count1
0 IVAR ^Count2
0 IVAR ^Count3
0 IVAR ^Cryotig_CR_ErrorFlag
0 IVAR ^CryoTigOffFlag
0 TVAR ^CryoTigThermalTimer
0 IVAR ^DeadmanFlag
0 IVAR ^done
0 TVAR ^dt24h
0 TVAR ^dtAirCon_CR
0 TVAR ^dtAwaitingDT
0 IVAR ^DTcharCount
0 IVAR ^DTcommStatus
0 IVAR ^DTdataErrorPosition
0 IVAR ^DTerrorFlag
0 TVAR ^dtFanMonitor
0 TVAR ^dtGooglePost
0 TVAR ^dtHeartbeat
0 IVAR ^DTlogFlag
0 TVAR ^dtRequestTimer
0 TVAR ^dtSocket
0 IVAR ^EcbBit
0 IVAR ^EcbCmd
0 IVAR ^EcbMsg
0 IVAR ^EcbResetFlag
0 IVAR ^EOM_term
0 IVAR ^Fan10V_TestFlag
0 IVAR ^FanCtrl
0 FVAR ^FanSpd
0 FVAR ^fCheck
0 FVAR ^fFanCtrl
0 FVAR ^fFanSpd
0 FVAR ^fPidInput
0 FVAR ^fRTD1_R0
0 FVAR ^fRTD2_R0
0 FVAR ^fRTD3_R0
0 FVAR ^fRTD4_R0
0 FVAR ^fRTD5_R0
0 FVAR ^fRTD6_R0
0 FVAR ^fRTD7_R0
0 FVAR ^fRTD8_R0
0 FVAR ^fSystemUpTime
0 IVAR ^GoogleCommStatus
0 IVAR ^IglooOverTemp
0 IVAR ^IglooStirFanM282_ErrorFlag
0 IVAR ^IglooStirFanM284_ErrorFlag
0 IVAR ^IglooStirFanM292_ErrorFlag
0 IVAR ^IglooStirFanM294_ErrorFlag
0 FVAR ^IglooTemp
0 IVAR ^IglooTempOK
0 IVAR ^intTest
0 IVAR ^Length1
0 IVAR ^MasterEcbCmd
0 IVAR ^MasterEcbFlag
0 IVAR ^n03AsIntStatus
0 IVAR ^n03AsIntSubStatus
0 IVAR ^nCharCount
0 IVAR ^nCounter1
0 IVAR ^nCounter2
0 IVAR ^nDTcharacterCount
0 IVAR ^nDTreceiveStatus
0 IVAR ^nFanSpd
0 IVAR ^nFindCmd
0 IVAR ^nGooglePostDataLength
0 IVAR ^nIndex
0 IVAR ^nIP_int
0 IVAR ^nLength
0 IVAR ^nModbusMasterReadDelay
0 IVAR ^nOctet3
0 IVAR ^nPortStatus
0 IVAR ^nReceiveStatus
0 IVAR ^NRES_CR_ErrorFlag
0 IVAR ^nStirFansSpd
0 IVAR ^nStringLength
0 IVAR ^nStringPosition
0 FVAR ^Old_AO_PanelFans_CTRL
0 FVAR ^Old_AO_StirFansCTRL
0 FVAR ^Old_AO_TentServoFan_Ctrl
0 FVAR ^Old_AO_TentStirFan_Ctrl
0 IVAR ^OldDTcommHandle
0 IVAR ^OldPosition
0 FVAR ^P119Temp
0 IVAR ^P119TempOK
0 IVAR ^PanelFanM184_ErrorFlag
0 IVAR ^PanelFanM186_ErrorFlag
0 FVAR ^PanelFanMaxCtrl
0 FVAR ^PanelTemp
0 IVAR ^Position
0 FVAR ^Preset
0 IVAR ^RedLink_CR_ErrorFlag
0 IVAR ^SendData
0 IVAR ^SubStringLength
0 IVAR ^TentExhaustFanM306_ErrorFlag
0 IVAR ^TentExhaustFanM314_ErrorFlag
0 IVAR ^TentIntakeFanM304_ErrorFlag
0 IVAR ^TentIntakeFanM312_ErrorFlag
0 IVAR ^TentStirFanM323_ErrorFlag
0 IVAR ^TentStirFanM325_ErrorFlag
0 FVAR ^TentStirFanMaxCtrl
0 FVAR ^TentTemp
0 IVAR ^TentTempOK
0 IVAR ^Thermostat_CR_ErrorFlag
0 TVAR ^Timer
0 IVAR ^Utility_Volt_WatchdogFlag
0 IVAR ^WriteToLogFailedFlag
0 IVAR ^x
0 IVAR ^y
10 0 $VAR *CRLF 
1024 0 $VAR *DTdata 
1024 0 $VAR *DTmessageReceived 
10 0 $VAR *LF 
32 0 $VAR *sCmd 
10 0 $VAR *sCounter2 
10 0 $VAR *sCryoTigThermalTimer 
10 0 $VAR *sCurrent 
20 0 $VAR *sCurrentDate 
50 0 $VAR *sCurrentLogCommHandle 
20 0 $VAR *sCurrentLogFile 
20 0 $VAR *sCurrentTime 
20 0 $VAR *sDate 
20 0 $VAR *sDatestamp 
10 0 $VAR *sDay 
10 0 $VAR *sDay1 
1024 0 $VAR *sDT_IP 
10 0 $VAR *sDTerror 
1024 0 $VAR *sDTrequest 
1024 0 $VAR *sErrorList 
10 0 $VAR *sFanSpd 
1024 0 $VAR *sFaultList 
50 0 $VAR *sFTPcmd 
10 0 $VAR *sFWversion 
500 0 $VAR *sGooglePostData 
10 0 $VAR *sGooglePostDataLength 
500 0 $VAR *sGooglePostHeader 
10 0 $VAR *sHeartbeat 
10 0 $VAR *sICDversion 
25 0 $VAR *sIP_hex 
25 0 $VAR *sIP_PAC 
1024 0 $VAR *sLog 
10 0 $VAR *sMonth 
10 0 $VAR *sMonth1 
1024 0 $VAR *sNewLog 
50 0 $VAR *sNewLogCommHandle 
20 0 $VAR *sNewLogFile 
10 0 $VAR *sOctet1 
10 0 $VAR *sOctet2 
10 0 $VAR *sOctet3 
20 0 $VAR *sOldDTerror 
10 0 $VAR *sPACuptime 
10 0 $VAR *sPID 
10 0 $VAR *sPidSetpoint 
10 0 $VAR *sPressure 
20 0 $VAR *sRTD1_R0 
20 0 $VAR *sRTD2_R0 
20 0 $VAR *sRTD3_R0 
20 0 $VAR *sRTD4_R0 
20 0 $VAR *sRTD5_R0 
20 0 $VAR *sRTD6_R0 
20 0 $VAR *sRTD7_R0 
20 0 $VAR *sRTD8_R0 
200 0 $VAR *sSDcard 
10 0 $VAR *sStirFansSpd 
10 0 $VAR *sSWversion 
1024 0 $VAR *Status 
10 0 $VAR *sTentFansSpd 
10 0 $VAR *sTime 
50 0 $VAR *sTimestamp 
50 0 $VAR *sTimestamp1 
50 0 $VAR *sTimestamp2 
30 0 $VAR *sTimestamp3 
30 0 $VAR *sTimestamp4 
10 0 $VAR *sVar 
20 0 $VAR *sVar1 
10 0 $VAR *sVoltage 
10 0 $VAR *sYear 
1024 0 COMVAR *ch_SDcard 
1024 0 COMVAR *chModbusMaster 
1024 0 COMVAR *cPort 
1024 0 COMVAR *DTcommHandle 
1024 0 COMVAR *FTPcommHandle 
1024 0 COMVAR *GoogleCommHandle 
1024 0 COMVAR *LogCommHandle 
16 0 ITABLE }EcbBitData
8 0 ITABLE }EcbStatus
10 0 ITABLE }nt03AsIntParameters
126 0 ITABLE }nt03HoldingRegAsIntReturnValues
16 0 ITABLE }ntEcbCmd
10 0 ITABLE }ntRTDdata
10 0 FTABLE }ntRTDtempData
30 30 0 $TABLE {stDTdata 
30 30 0 $TABLE {stHeader 
30 30 0 $TABLE {stModbusData 

nullM64BOARD $FFFFFFFE $FFFFFFFE 16 32769 1.000000 0.010000 0.000000 2001 $7F000001 0 11 BOARD.MMP %local_io
32  1 SPOINT 0.0     INPUT  0  0 %local_io 0 POINT.TNG ~DI_AirCon_CR_NC
32  1 SPOINT 0.0     INPUT  1  0 %local_io 0 POINT.TNG ~DI_NRES_CR_NO
32  1 SPOINT 0.0     INPUT  2  0 %local_io 0 POINT.TNG ~DI_CryoTig_CR_NC
32  1 SPOINT 0.0     INPUT  3  0 %local_io 0 POINT.TNG ~DI_LightSW
32  1 SPOINT 0.0     INPUT  4  0 %local_io 0 POINT.TNG ~DI_TVS
32  1 SPOINT 0.0     INPUT  5  0 %local_io 0 POINT.TNG ~DI_EntryDoor
32  1 SPOINT 0.0     INPUT  7  0 %local_io 0 POINT.TNG ~DI_PanelDoor
32  1 SPOINT 0.0     INPUT  9  0 %local_io 0 POINT.TNG ~DI_Spare_CR_NC
32  1 SPOINT 0.0     INPUT 10  0 %local_io 0 POINT.TNG ~DI_AirConPWR_OK
32  1 SPOINT 0.0     INPUT 12  0 %local_io 0 POINT.TNG ~DI_NRES_PWR_OK
32  1 SPOINT 0.0     INPUT 15  0 %local_io 0 POINT.TNG ~DI_ECB_OK
32  1 SPOINT 0.0     INPUT 16  0 %local_io 0 POINT.TNG ~DI_SmokePWR_OK
32  1 SPOINT 0.0     INPUT 17  0 %local_io 0 POINT.TNG ~DI_SmokeAlarm
32  1 SPOINT 0.0     INPUT 18  0 %local_io 0 POINT.TNG ~DI_HeatAlarm
 4  1 SPOINT 0.0     INPUT  0  1 %local_io 0 POINT.TNG ~DI_NRES_Deadman
 4  1 SPOINT 0.0    OUTPUT  0  2 %local_io 0 POINT.TNG ~DO_AirCon_CR
 4  1 SPOINT 0.0    OUTPUT  1  2 %local_io 0 POINT.TNG ~DO_NRES_CR
 4  1 SPOINT 0.0    OUTPUT  2  2 %local_io 0 POINT.TNG ~DO_CryoTig_CR
 4  1 SPOINT 0.0    OUTPUT  3  2 %local_io 0 POINT.TNG ~DO_ECB_Tx
 2  1 APOINT    0.0000 70  0  3 %local_io 0 POINT.TNG ~AI_CryoTig_Volt
 2  1 APOINT    0.0000 70  1  3 %local_io 0 1000.000000 1 POINT.TNGX ~AI_Utility_Volt
 4  1 APOINT  -15.0000 64  0  4 %local_io 0 POINT.TNG ~AI_CryoTig_Current
  10.0000  -15.0000 ~AI_CryoTig_Current SET.SCALE
 4  1 APOINT  -37.5000 64  1  4 %local_io 0 POINT.TNG ~AI_HVAC_Current
  25.0000  -37.5000 ~AI_HVAC_Current SET.SCALE
 4  1 APOINT -206.6665 64  2  4 %local_io 0 POINT.TNG ~AI_P119_Temp
  71.1110 -206.6665 ~AI_P119_Temp SET.SCALE
 4  1 APOINT -206.6665 64  3  4 %local_io 0 POINT.TNG ~AI_Igloo_Temp
  71.1110 -206.6665 ~AI_Igloo_Temp SET.SCALE
 4  1 APOINT -500.0000 12  0  5 %local_io 0 POINT.TNG ~AI_CryoTig_OutputPressure
 500.0000 -500.0000 ~AI_CryoTig_OutputPressure SET.SCALE
 4  1 APOINT -329.4000 12  1  5 %local_io 0 POINT.TNG ~AI_CryoTig_ReturnPressure
 300.0000 -329.4000 ~AI_CryoTig_ReturnPressure SET.SCALE
 4  1 APOINT -4000.0000 12  2  5 %local_io 0 1000.000000 1 POINT.TNGX ~AI_CA_SupplyPressure
4000.0000 -4000.0000 ~AI_CA_SupplyPressure SET.SCALE
 2  1 APOINT    0.0000 165  0  6 %local_io 0 POINT.TNG ~AO_PanelFans_CTRL
 2  1 APOINT    0.0000 165  1  6 %local_io 0 POINT.TNG ~AO_StirFans_CTRL
 2  1 APOINT    0.0000 69  0  7 %local_io 0 POINT.TNG ~AI_PanelFanM184_Tach
 2  1 APOINT    0.0000 69  1  7 %local_io 0 POINT.TNG ~AI_PanelFanM186_Tach
 2  1 APOINT    0.0000 69  0  9 %local_io 0 POINT.TNG ~AI_IglooStirFanM282_Tach
 2  1 APOINT    0.0000 69  1  9 %local_io 0 POINT.TNG ~AI_IglooStirFanM284_Tach
 2  1 APOINT    0.0000 69  0 10 %local_io 0 POINT.TNG ~AI_IglooStirFanM292_Tach
 2  1 APOINT    0.0000 69  1 10 %local_io 0 POINT.TNG ~AI_IglooStirFanM294_Tach
 2  1 APOINT    0.0000 69  0 11 %local_io 0 POINT.TNG ~AI_TentStirFanM323_Tach
 2  1 APOINT    0.0000 69  1 11 %local_io 0 POINT.TNG ~AI_TentStirFanM325_Tach
 2  1 APOINT    0.0000 69  0 12 %local_io 0 POINT.TNG ~AI_TentIntakeFanM304_Tach
 2  1 APOINT    0.0000 69  1 12 %local_io 0 POINT.TNG ~AI_TentExhaustFanM306_Tach
 2  1 APOINT    0.0000 165  0 13 %local_io 0 POINT.TNG ~AO_TentServoFan_Ctrl
 2  1 APOINT    0.0000 165  1 13 %local_io 0 POINT.TNG ~AO_TentStirFan_Ctrl
 2  1 APOINT    0.0000 69  0 14 %local_io 0 POINT.TNG ~AI_TentIntakeFanM312_Tach
 2  1 APOINT    0.0000 69  1 14 %local_io 0 POINT.TNG ~AI_TentExhaustFanM314_Tach
 4  1 SPOINT 0.0     INPUT  0 15 %local_io 0 POINT.TNG ~DI_ECB_Rx
1    0.0000    0.0000    0.0000    0.0000    0.8500   10.0000    0.0000   50.0000
   1.0000    0.0000    0.0000   25.0000    0.0500    0.3000
   0.0000    0.0000 ~AO_TentServoFan_Ctrl
$b0000000 0 %local_io 0 PID |pidTentFans
: 1_0
0 JUMP ;
: 1_1

1 LINE.NUM
  *DTcommHandle   OPEN
  ^DTcommStatus @! 
10 JUMP ;
: 1_5
1 LINE.NUM 1000  DELAY 
-2 JUMP ;
: 1_21
1 LINE.NUM *DTcommHandle  CLOSE DROP  
-3 JUMP ;
: 1_25
1 LINE.NUM 12 I>F ^dtAwaitingDT @! 
2 LINE.NUM ^dtAwaitingDT  StartTimer 
0 JUMP ;
: 1_27
1 LINE.NUM *DTcommHandle  ?STREAM.KEY ^DTcharCount @! 
7 JUMP ;
: 1_31
9 LINE.NUM *DTcommHandle 13  S.!EOL 
10 LINE.NUM " " *DTmessageReceived  $MOVE 
11 LINE.NUM " " *sDTerror  $MOVE 
12 LINE.NUM *DTmessageReceived *DTcommHandle  GET$ ^nDTreceiveStatus @! 
13 LINE.NUM 69 0 *DTmessageReceived  FindChar ^DTdataErrorPosition @! 
14 LINE.NUM ^DTdataErrorPosition @@ 0 >= IF 
15 LINE.NUM *DTmessageReceived *sDTerror  $MOVE 
16 LINE.NUM 1 ^DTerrorFlag @! 
17 LINE.NUM *DTcommHandle 10  S.!EOL 
18 LINE.NUM *DTmessageReceived *DTcommHandle  GET$ ^nDTreceiveStatus @! 
19 LINE.NUM *DTcommHandle 13  S.!EOL 
20 LINE.NUM *DTmessageReceived *DTcommHandle  GET$ ^nDTreceiveStatus @! 
21 LINE.NUM THEN 
35 LINE.NUM 12 I>F ^dtAwaitingDT @! 
36 LINE.NUM ^dtAwaitingDT  StartTimer 
11 JUMP ;
: 1_40
1 LINE.NUM 10  DELAY 
-3 JUMP ;
: 1_53
-4 JUMP ;
: 1_55
1 LINE.NUM *DTcommHandle  STREAM.CLEAR.BUF 
0 JUMP ;
: 1_57
1 LINE.NUM *sTimestamp1 &Timestamp CALL.SUB DROP  
2 LINE.NUM *sTimestamp1 0 {stDTdata $TABLE@  $MOVE 
4 LINE.NUM " " *DTdata $MOVE 32 *DTdata  $APPEND 
5 LINE.NUM *DTmessageReceived *DTdata $CAT 

6 LINE.NUM 32 *DTdata $APPEND 

7 LINE.NUM *DTdata  $LEN ^Length1 @! 
8 LINE.NUM 1 ^nCounter1 @! 
9 LINE.NUM 0 ^Position @! 
10 LINE.NUM 0 ^done @! 
12 LINE.NUM BEGIN 
13 LINE.NUM ^Position @@ ^OldPosition @! 
14 LINE.NUM ^OldPosition @@ ^Length1 @@ 1 -  = IF 
15 LINE.NUM 1 ^done @! 
16 LINE.NUM THEN 
17 LINE.NUM 32 ^OldPosition @@ 1 +  *DTdata  FindChar ^Position @! 
18 LINE.NUM ^Position @@ ^OldPosition @@ -  1 -  ^SubStringLength @! 
19 LINE.NUM *DTdata ^OldPosition @@ 1 +  ^SubStringLength @@ ^nCounter1 @@ {stDTdata $TABLE@  $SUB 
20 LINE.NUM ^nCounter1 @@ 1 +  ^nCounter1 @! 
21 LINE.NUM ^done @@ 1 = UNTIL 
23 LINE.NUM 1 ^DTlogFlag @! 
-3 JUMP ;
: 1_65
1 LINE.NUM " BEGIN" *sDTrequest  $MOVE 
2 LINE.NUM "  /h /e /u /n" *sDTrequest $CAT 

3 LINE.NUM "  RD3S" *sDTrequest $CAT 

5 LINE.NUM "  1PT385(4W," *sDTrequest $CAT 

6 LINE.NUM *sRTD1_R0 *sDTrequest $CAT 

7 LINE.NUM " )" *sDTrequest $CAT 

9 LINE.NUM "  2PT385(4W," *sDTrequest $CAT 

10 LINE.NUM *sRTD2_R0 *sDTrequest $CAT 

11 LINE.NUM " )" *sDTrequest $CAT 

13 LINE.NUM "  3PT385(4W," *sDTrequest $CAT 

14 LINE.NUM *sRTD3_R0 *sDTrequest $CAT 

15 LINE.NUM " )" *sDTrequest $CAT 

17 LINE.NUM "  4PT385(4W," *sDTrequest $CAT 

18 LINE.NUM *sRTD4_R0 *sDTrequest $CAT 

19 LINE.NUM " )" *sDTrequest $CAT 

21 LINE.NUM "  5PT385(4W," *sDTrequest $CAT 

22 LINE.NUM *sRTD5_R0 *sDTrequest $CAT 

23 LINE.NUM " )" *sDTrequest $CAT 

25 LINE.NUM "  6PT385(4W," *sDTrequest $CAT 

26 LINE.NUM *sRTD6_R0 *sDTrequest $CAT 

27 LINE.NUM " )" *sDTrequest $CAT 

29 LINE.NUM "  7PT385(4W," *sDTrequest $CAT 

30 LINE.NUM *sRTD7_R0 *sDTrequest $CAT 

31 LINE.NUM " )" *sDTrequest $CAT 

33 LINE.NUM "  8PT385(4W," *sDTrequest $CAT 

34 LINE.NUM *sRTD8_R0 *sDTrequest $CAT 

35 LINE.NUM " )" *sDTrequest $CAT 

37 LINE.NUM "  9PT385(4W)" *sDTrequest $CAT 

38 LINE.NUM "  10PT385(4W)" *sDTrequest $CAT 

39 LINE.NUM "  12PT385(4W)" *sDTrequest $CAT 

41 LINE.NUM "  END" *sDTrequest $CAT 

42 LINE.NUM *CRLF *sDTrequest $CAT 

44 LINE.NUM *sDTrequest *DTcommHandle  PRT$ DROP  
45 LINE.NUM " " *sDTrequest  $MOVE 
46 LINE.NUM 2 I>F  FDELAY 
47 LINE.NUM *DTcommHandle  STREAM.CLEAR.BUF 
-8 JUMP ;
: 1_3
FALSE

1 LINE.NUM
  ^DTcommStatus @@ 
  0    =
LOR

2 LINE.NUM
  ^DTcommStatus @@ 
  -47    =
LOR
IF -2 ELSE -11 THEN JUMP ;
: 1_29
TRUE

1 LINE.NUM
  ^DTcharCount @@ 
  0    >
LAND
IF 3 ELSE 0 THEN JUMP ;
: 1_34
TRUE

1 LINE.NUM
  ^DTcharCount @@ 
  -52    =
LAND
IF -12 ELSE 0 THEN JUMP ;
: 1_35
TRUE

1 LINE.NUM
  ^dtAwaitingDT   T0=
LAND
IF -13 ELSE 0 THEN JUMP ;
: 1_36
FALSE

1 LINE.NUM
  ^DTcharCount @@ 
  0    =
LOR

2 LINE.NUM
  ^DTcharCount @@ 
  -37    =
LOR

3 LINE.NUM
  ^DTcharCount @@ 
  -39    =
LOR
IF -10 ELSE -14 THEN JUMP ;
: 1_44
TRUE

1 LINE.NUM
  ^DTcharCount @@ 
  4    <
LAND
IF -15 ELSE -12 THEN JUMP ;
: 1_48
TRUE

1 LINE.NUM
  ^nDTreceiveStatus @@ 
  0    =
LAND
IF -10 ELSE 0 THEN JUMP ;
: 1_49
TRUE

1 LINE.NUM
  ^nDTreceiveStatus @@ 
  -39    =
LAND
IF -12 ELSE -17 THEN JUMP ;
T: T1
DUMMY
1_0
1_1
1_5
1_21
1_25
1_27
1_31
1_40
1_53
1_55
1_57
1_65
1_3
1_29
1_34
1_35
1_36
1_44
1_48
1_49
T;
&DatatakerComm ' T1 SETTASK
: 3_0
1 JUMP ;
: 3_5
1 LINE.NUM 2 I>F  FDELAY 
0 JUMP ;
: 3_8

1 LINE.NUM
  *GoogleCommHandle   OPEN
  ^GoogleCommStatus @! 
4 JUMP ;
: 3_11
1 LINE.NUM *GoogleCommHandle  CLOSE DROP  
-2 JUMP ;
: 3_16
1 LINE.NUM 100  DELAY 
3 JUMP ;
: 3_19
1 LINE.NUM 30 I>F ^dtGooglePost @! 
2 LINE.NUM ^dtGooglePost  StartTimer 
3 JUMP ;
: 3_20
1 LINE.NUM " " *sGooglePostData  $MOVE 
2 LINE.NUM 0 ^nGooglePostDataLength @! 
3 LINE.NUM " " *sGooglePostDataLength  $MOVE 
4 LINE.NUM " " *sGooglePostHeader  $MOVE 
6 LINE.NUM " entry.2024874833=" *sGooglePostData $CAT 

7 LINE.NUM 0 {stDTdata $TABLE@ *sGooglePostData $CAT 

8 LINE.NUM " &" *sGooglePostData $CAT 

9 LINE.NUM " entry.757903361=" *sGooglePostData $CAT 

10 LINE.NUM 1 {stDTdata $TABLE@ *sGooglePostData $CAT 

11 LINE.NUM " &" *sGooglePostData $CAT 

12 LINE.NUM " submit=Submit" *sGooglePostData $CAT 

13 LINE.NUM *sGooglePostData  $LEN ^nGooglePostDataLength @! 
14 LINE.NUM ^nGooglePostDataLength @@ *sGooglePostDataLength  I>$ 
16 LINE.NUM " POST /formResponse?formkey=" *sGooglePostHeader $CAT 

17 LINE.NUM " 10R4nOO5nooYZWUYanMYz1qx_lkdwBeV59FZfeKOidDQ" *sGooglePostHeader $CAT 

18 LINE.NUM " &ifq HTTP/1.1" *sGooglePostHeader $CAT 

19 LINE.NUM *CRLF *sGooglePostHeader $CAT 

20 LINE.NUM " Host: spreadsheets.google.com" *sGooglePostHeader $CAT 

21 LINE.NUM *CRLF *sGooglePostHeader $CAT 

22 LINE.NUM " Content-Type: application/x-www-form-urlencoded" *sGooglePostHeader $CAT 

23 LINE.NUM *CRLF *sGooglePostHeader $CAT 

24 LINE.NUM " Connection: close" *sGooglePostHeader $CAT 

25 LINE.NUM *CRLF *sGooglePostHeader $CAT 

26 LINE.NUM " Content-Length: " *sGooglePostHeader $CAT 

27 LINE.NUM *sGooglePostDataLength *sGooglePostHeader $CAT 

28 LINE.NUM *CRLF *sGooglePostHeader $CAT 

29 LINE.NUM *CRLF *sGooglePostHeader $CAT 

30 LINE.NUM *sGooglePostData *sGooglePostHeader $CAT 

31 LINE.NUM *CRLF *sGooglePostHeader $CAT 

33 LINE.NUM *sGooglePostHeader *GoogleCommHandle  PRT$ DROP  
-2 JUMP ;
: 3_7
FALSE

1 LINE.NUM
  ^GoogleCommStatus @@ 
  0    =
LOR

2 LINE.NUM
  ^GoogleCommStatus @@ 
  -47    =
LOR
IF -3 ELSE -7 THEN JUMP ;
: 3_14
TRUE

1 LINE.NUM
  *GoogleCommHandle   ?OPEN 0>
LAND
IF 0 ELSE -6 THEN JUMP ;
: 3_18
TRUE

1 LINE.NUM
  ^dtGooglePost   T0=
LAND
IF -4 ELSE -6 THEN JUMP ;
T: T3
DUMMY
3_0
3_5
3_8
3_11
3_16
3_19
3_20
3_7
3_14
3_18
T;
&GoogleComm ' T3 SETTASK
: 2_0
1 JUMP ;
: 2_1
3 LINE.NUM *sTimestamp2 &Timestamp CALL.SUB DROP  
5 LINE.NUM *DTcommHandle  ?OPEN 0> IF 
6 LINE.NUM 1 ^OldDTcommHandle @! 
7 LINE.NUM ELSE 
8 LINE.NUM ^OldDTcommHandle @@ 1 = IF 
9 LINE.NUM " , DatatakerComm " *sFaultList $CAT 

10 LINE.NUM *sTimestamp2 *sFaultList $CAT 

11 LINE.NUM 0 ^OldDTcommHandle @! 
12 LINE.NUM THEN 
13 LINE.NUM THEN 
17 LINE.NUM 1 {stDTdata $TABLE@  $>F ^TentTemp @! 
18 LINE.NUM ^TentTemp @@ 30 I>F F< ^TentTemp @@ 500000 I>F F> LOR  IF 
19 LINE.NUM 1 ^TentTempOK @! 
20 LINE.NUM ELSE 
21 LINE.NUM " , TentOverTemp " *sFaultList $CAT 

22 LINE.NUM *sTimestamp2 *sFaultList $CAT 

23 LINE.NUM 0 ^TentTempOK @! 
24 LINE.NUM THEN 
27 LINE.NUM ~AI_P119_Temp @@ ^IglooTemp @! 
28 LINE.NUM ^IglooTemp @@ 30 I>F F< ^IglooTemp @@ 500000 I>F F> LOR  IF 
29 LINE.NUM 1 ^IglooTempOK @! 
30 LINE.NUM ELSE 
31 LINE.NUM " , IglooOverTemp " *sFaultList $CAT 

32 LINE.NUM *sTimestamp2 *sFaultList $CAT 

33 LINE.NUM 0 ^IglooTempOK @! 
34 LINE.NUM THEN 
37 LINE.NUM 11 {stDTdata $TABLE@  $>F ^P119Temp @! 
38 LINE.NUM ^P119Temp @@ 35 I>F F< IF 
39 LINE.NUM 1 ^P119TempOK @! 
40 LINE.NUM ELSE 
41 LINE.NUM ^P119TempOK @@ 1 = IF 
42 LINE.NUM " , P119OverTemp " *sFaultList $CAT 

43 LINE.NUM *sTimestamp2 *sFaultList $CAT 

44 LINE.NUM 0 ^P119TempOK @! 
45 LINE.NUM THEN 
46 LINE.NUM THEN 
49 LINE.NUM ~DI_SmokeAlarm  CLR.-LATCH@I IF 
50 LINE.NUM " , SmokeAlarm " *sFaultList $CAT 

51 LINE.NUM *sTimestamp2 *sFaultList $CAT 

52 LINE.NUM THEN 
55 LINE.NUM ~DI_HeatAlarm  CLR.+LATCH@I IF 
56 LINE.NUM " , HighHeatAlarm " *sFaultList $CAT 

57 LINE.NUM *sTimestamp2 *sFaultList $CAT 

58 LINE.NUM THEN 
61 LINE.NUM ~DI_EntryDoor @@I 1 = IF 
63 LINE.NUM ~DI_LightSW  CLR.+LATCH@I IF 
64 LINE.NUM " , Lights_On" *sFaultList $CAT 

65 LINE.NUM *sTimestamp2 *sFaultList $CAT 

66 LINE.NUM THEN 
68 LINE.NUM THEN 
1 JUMP ;
: 2_2
1 LINE.NUM 500  DELAY 
-2 JUMP ;
: 2_6
5 LINE.NUM *sTimestamp3 &Timestamp CALL.SUB DROP  
8 LINE.NUM ^WriteToLogFailedFlag @@ 1 = IF 
9 LINE.NUM " , WriteToLogFailed " *sErrorList $CAT 

10 LINE.NUM *sTimestamp3 *sErrorList $CAT 

11 LINE.NUM 0 ^WriteToLogFailedFlag @! 
12 LINE.NUM THEN 
15 LINE.NUM ^DTerrorFlag @@ 1 = *sOldDTerror *sDTerror  $CMP 0 <> LAND  IF 
16 LINE.NUM " , DatatakerError=" *sErrorList $CAT 

17 LINE.NUM *sDTerror *sErrorList $CAT 

18 LINE.NUM "  " *sErrorList $CAT 

19 LINE.NUM *sTimestamp3 *sErrorList $CAT 

20 LINE.NUM 0 ^DTerrorFlag @! 
21 LINE.NUM *sDTerror *sOldDTerror  $MOVE 
22 LINE.NUM THEN 
25 LINE.NUM ^AirCon_CR_ErrorFlag @@ 1 = IF 
26 LINE.NUM " , AirCon_CtrlRelay_StuckON " *sErrorList $CAT 

27 LINE.NUM *sTimestamp3 *sErrorList $CAT 

28 LINE.NUM 0 ^AirCon_CR_ErrorFlag @! 
29 LINE.NUM THEN 
32 LINE.NUM ~DI_AirConPWR_OK  CLR.-LATCH@I IF 
33 LINE.NUM " , AirCon_Power " *sErrorList $CAT 

34 LINE.NUM *sTimestamp3 *sErrorList $CAT 

35 LINE.NUM THEN 
38 LINE.NUM ~DI_NRES_PWR_OK  CLR.-LATCH@I IF 
39 LINE.NUM " , NRES_Power " *Status $CAT 

40 LINE.NUM *sTimestamp3 *sErrorList $CAT 

41 LINE.NUM THEN 
44 LINE.NUM ^DeadmanFlag @@ 1 = IF 
45 LINE.NUM " , NRES_Deadman " *Status $CAT 

46 LINE.NUM *sTimestamp3 *sErrorList $CAT 

47 LINE.NUM 0 ^DeadmanFlag @! 
48 LINE.NUM THEN 
51 LINE.NUM ^NRES_CR_ErrorFlag @@ 1 = IF 
52 LINE.NUM " , NRES_CtrlRelay_StuckON " *sErrorList $CAT 

53 LINE.NUM *sTimestamp3 *sErrorList $CAT 

54 LINE.NUM 0 ^NRES_CR_ErrorFlag @! 
55 LINE.NUM THEN 
58 LINE.NUM ^Cryotig_CR_ErrorFlag @@ 1 = IF 
59 LINE.NUM " , CryoTig_CtrlRelay_StuckON " *sErrorList $CAT 

60 LINE.NUM *sTimestamp3 *sErrorList $CAT 

61 LINE.NUM 0 ^Cryotig_CR_ErrorFlag @! 
62 LINE.NUM THEN 
65 LINE.NUM ~DI_TVS  CLR.-LATCH@I IF 
66 LINE.NUM " , Surge_Protection " *sErrorList $CAT 

67 LINE.NUM *sTimestamp3 *sErrorList $CAT 

68 LINE.NUM THEN 
71 LINE.NUM ^Thermostat_CR_ErrorFlag @@ 1 = IF 
72 LINE.NUM " , Thermostat_Relay " *sErrorList $CAT 

73 LINE.NUM *sTimestamp3 *sErrorList $CAT 

74 LINE.NUM 0 ^Thermostat_CR_ErrorFlag @! 
75 LINE.NUM THEN 
78 LINE.NUM ^RedLink_CR_ErrorFlag @@ 1 = IF 
79 LINE.NUM " , RedLink_Relay " *sErrorList $CAT 

80 LINE.NUM *sTimestamp3 *sErrorList $CAT 

81 LINE.NUM 0 ^RedLink_CR_ErrorFlag @! 
82 LINE.NUM THEN 
85 LINE.NUM ~DI_SmokePWR_OK  CLR.-LATCH@I IF 
86 LINE.NUM " , SmokeAlarm_PowerOff " *sErrorList $CAT 

87 LINE.NUM *sTimestamp3 *sErrorList $CAT 

88 LINE.NUM THEN 
91 LINE.NUM ^IglooStirFanM282_ErrorFlag @@ 1 = IF 
92 LINE.NUM " IglooStirFanM28.2_Speed" 0 *sErrorList  FindSubString ^y @! 
93 LINE.NUM ^y @@ 0 < IF 
94 LINE.NUM " , IglooStirFanM28.2_Speed " *sErrorList $CAT 

95 LINE.NUM *sTimestamp3 *sErrorList $CAT 

96 LINE.NUM 0 ^IglooStirFanM282_ErrorFlag @! 
97 LINE.NUM THEN 
98 LINE.NUM THEN 
101 LINE.NUM ^IglooStirFanM284_ErrorFlag @@ 1 = IF 
102 LINE.NUM " IglooStirFanM28.4_Speed" 0 *sErrorList  FindSubString ^y @! 
103 LINE.NUM ^y @@ 0 < IF 
104 LINE.NUM " , IglooStirFanM28.4_Speed " *sErrorList $CAT 

105 LINE.NUM *sTimestamp3 *sErrorList $CAT 

106 LINE.NUM 0 ^IglooStirFanM284_ErrorFlag @! 
107 LINE.NUM THEN 
108 LINE.NUM THEN 
111 LINE.NUM ^IglooStirFanM292_ErrorFlag @@ 1 = IF 
112 LINE.NUM " IglooStirFanM29.2_Speed" 0 *sErrorList  FindSubString ^y @! 
113 LINE.NUM ^y @@ 0 < IF 
114 LINE.NUM " , IglooStirFanM29.2_Speed " *sErrorList $CAT 

115 LINE.NUM *sTimestamp3 *sErrorList $CAT 

116 LINE.NUM 0 ^IglooStirFanM292_ErrorFlag @! 
117 LINE.NUM THEN 
118 LINE.NUM THEN 
121 LINE.NUM ^IglooStirFanM294_ErrorFlag @@ 1 = IF 
122 LINE.NUM " IglooStirFanM29.4_Speed" 0 *sErrorList  FindSubString ^y @! 
123 LINE.NUM ^y @@ 0 < IF 
124 LINE.NUM " , IglooStirFanM29.4_Speed " *sErrorList $CAT 

125 LINE.NUM *sTimestamp3 *sErrorList $CAT 

126 LINE.NUM 0 ^IglooStirFanM294_ErrorFlag @! 
127 LINE.NUM THEN 
128 LINE.NUM THEN 
131 LINE.NUM ^TentIntakeFanM304_ErrorFlag @@ 1 = IF 
132 LINE.NUM " TentIntakeFanM30.4_Speed" 0 *sErrorList  FindSubString ^y @! 
133 LINE.NUM ^y @@ 0 < IF 
134 LINE.NUM " , TentIntakeFanM30.4_Speed " *sErrorList $CAT 

135 LINE.NUM *sTimestamp3 *sErrorList $CAT 

136 LINE.NUM 0 ^TentIntakeFanM304_ErrorFlag @! 
137 LINE.NUM THEN 
138 LINE.NUM THEN 
141 LINE.NUM ^TentExhaustFanM306_ErrorFlag @@ 1 = IF 
142 LINE.NUM " TentExhaustFanM30.6_Speed" 0 *sErrorList  FindSubString DROP  
143 LINE.NUM ^y @@ 0 < IF 
144 LINE.NUM " , TentExhaustFanM30.6_Speed " *sErrorList $CAT 

145 LINE.NUM *sTimestamp3 *sErrorList $CAT 

146 LINE.NUM 0 ^TentExhaustFanM306_ErrorFlag @! 
147 LINE.NUM THEN 
148 LINE.NUM THEN 
151 LINE.NUM ^TentIntakeFanM312_ErrorFlag @@ 1 = IF 
152 LINE.NUM " TentIntakeFanM31.2_Speed" 0 *sErrorList  FindSubString ^y @! 
153 LINE.NUM ^y @@ 0 < IF 
154 LINE.NUM " , TentIntakeFanM31.2_Speed " *sErrorList $CAT 

155 LINE.NUM *sTimestamp3 *sErrorList $CAT 

156 LINE.NUM 0 ^TentIntakeFanM312_ErrorFlag @! 
157 LINE.NUM THEN 
158 LINE.NUM THEN 
161 LINE.NUM ^TentExhaustFanM314_ErrorFlag @@ 1 = IF 
162 LINE.NUM " TentExhaustFanM31.4_Speed" 0 *sErrorList  FindSubString ^y @! 
163 LINE.NUM ^y @@ 0 < IF 
164 LINE.NUM " , TentExhaustFanM31.4_Speed " *sErrorList $CAT 

165 LINE.NUM *sTimestamp3 *sErrorList $CAT 

166 LINE.NUM 0 ^TentExhaustFanM314_ErrorFlag @! 
167 LINE.NUM THEN 
168 LINE.NUM THEN 
171 LINE.NUM ^PanelFanM184_ErrorFlag @@ 1 = IF 
172 LINE.NUM " PanelFanM18.4_Speed" 0 *sErrorList  FindSubString ^y @! 
173 LINE.NUM ^y @@ 0 < IF 
174 LINE.NUM " , PanelFanM18.4_Speed " *sErrorList $CAT 

175 LINE.NUM *sTimestamp3 *sErrorList $CAT 

176 LINE.NUM 0 ^PanelFanM184_ErrorFlag @! 
177 LINE.NUM THEN 
178 LINE.NUM THEN 
181 LINE.NUM ^PanelFanM186_ErrorFlag @@ 1 = IF 
182 LINE.NUM " PanelFanM18.6_Speed" 0 *sErrorList  FindSubString ^y @! 
183 LINE.NUM ^y @@ 0 < IF 
184 LINE.NUM " , PanelFanM18.6_Speed " *sErrorList $CAT 

185 LINE.NUM *sTimestamp3 *sErrorList $CAT 

186 LINE.NUM 0 ^PanelFanM186_ErrorFlag @! 
187 LINE.NUM THEN 
188 LINE.NUM THEN 
191 LINE.NUM ^TentStirFanM323_ErrorFlag @@ 1 = IF 
192 LINE.NUM " TentStirFanM32.3_Speed" 0 *sErrorList  FindSubString ^y @! 
193 LINE.NUM ^y @@ 0 < IF 
194 LINE.NUM " , TentStirFanM32.3_Speed " *sErrorList $CAT 

195 LINE.NUM *sTimestamp3 *sErrorList $CAT 

196 LINE.NUM 0 ^TentStirFanM323_ErrorFlag @! 
197 LINE.NUM THEN 
198 LINE.NUM THEN 
201 LINE.NUM ^TentStirFanM325_ErrorFlag @@ 1 = IF 
202 LINE.NUM " TentStirFanM32.5_Speed" 0 *sErrorList  FindSubString ^y @! 
203 LINE.NUM ^y @@ 0 < IF 
204 LINE.NUM " , TentStirFanM32.5_Speed " *sErrorList $CAT 

205 LINE.NUM *sTimestamp3 *sErrorList $CAT 

206 LINE.NUM 0 ^TentStirFanM325_ErrorFlag @! 
207 LINE.NUM THEN 
208 LINE.NUM THEN 
211 LINE.NUM ~DI_ECB_OK  CLR.-LATCH@I IF 
212 LINE.NUM " , DC_MCB " *sErrorList $CAT 

213 LINE.NUM *sTimestamp3 *sErrorList $CAT 

214 LINE.NUM THEN 
217 LINE.NUM 2 }EcbStatus TABLE@ 2 < IF 
218 LINE.NUM " Datataker_MCB" 0 *sErrorList  FindSubString ^y @! 
219 LINE.NUM ^y @@ 0 < IF 
220 LINE.NUM " , Datataker_MCB " *sErrorList $CAT 

221 LINE.NUM *sTimestamp3 *sErrorList $CAT 

222 LINE.NUM THEN 
223 LINE.NUM THEN 
226 LINE.NUM 3 }EcbStatus TABLE@ 2 < IF 
227 LINE.NUM " StirFans_M28.2_M28.4_MCB" 0 *sErrorList  FindSubString ^y @! 
228 LINE.NUM ^y @@ 0 < IF 
229 LINE.NUM " , StirFans_M28.2_M28.4_MCB " *sErrorList $CAT 

230 LINE.NUM *sTimestamp3 *sErrorList $CAT 

231 LINE.NUM THEN 
232 LINE.NUM THEN 
235 LINE.NUM 4 }EcbStatus TABLE@ 2 < IF 
236 LINE.NUM " StirFans_M29.2_M29.4_MCB" 0 *sErrorList  FindSubString ^y @! 
237 LINE.NUM ^y @@ 0 < IF 
238 LINE.NUM " , StirFans_M29.2_M29.4_MCB " *sErrorList $CAT 

239 LINE.NUM *sTimestamp3 *sErrorList $CAT 

240 LINE.NUM THEN 
241 LINE.NUM THEN 
244 LINE.NUM 5 }EcbStatus TABLE@ 2 < IF 
245 LINE.NUM " TentFans_M30.4_M30.6_MCB" 0 *sErrorList  FindSubString ^y @! 
246 LINE.NUM ^y @@ 0 < IF 
247 LINE.NUM " , TentFans_M30.4_M30.6_MCB " *sErrorList $CAT 

248 LINE.NUM *sTimestamp3 *sErrorList $CAT 

249 LINE.NUM THEN 
250 LINE.NUM THEN 
253 LINE.NUM 7 }EcbStatus TABLE@ 2 < IF 
254 LINE.NUM " TentFans_M31.2_M31.4_MCB" 0 *sErrorList  FindSubString ^y @! 
255 LINE.NUM ^y @@ 0 < IF 
256 LINE.NUM " , TentFans_M31.2_M31.4_MCB " *sErrorList $CAT 

257 LINE.NUM *sTimestamp3 *sErrorList $CAT 

258 LINE.NUM THEN 
259 LINE.NUM THEN 
262 LINE.NUM 6 }EcbStatus TABLE@ 2 < IF 
263 LINE.NUM " TentStirFans_MCB" 0 *sErrorList  FindSubString ^y @! 
264 LINE.NUM ^y @@ 0 < IF 
265 LINE.NUM " , TentStirFans_MCB " *sErrorList $CAT 

266 LINE.NUM *sTimestamp3 *sErrorList $CAT 

267 LINE.NUM THEN 
268 LINE.NUM THEN 
8 JUMP ;
: 2_8
4 LINE.NUM ^DTlogFlag @@ 1 = IF 
5 LINE.NUM |pidTentFans  $0002.. ROT PID@ 4 1 *sVar  FF.R$ 
6 LINE.NUM *sVar 9 {stDTdata $TABLE@  $MOVE 
7 LINE.NUM |pidTentFans  $0001.. ROT PID@ 4 1 *sVar  FF.R$ 
8 LINE.NUM *sVar 10 {stDTdata $TABLE@  $MOVE 
9 LINE.NUM |pidTentFans  $0008.. ROT PID@ 4 1 *sVar  FF.R$ 
10 LINE.NUM *sVar 11 {stDTdata $TABLE@  $MOVE 
12 LINE.NUM ~AI_TentIntakeFanM304_Tach @@ 60 I>F F* 3 I>F F/ ^fFanSpd @! 
13 LINE.NUM ^fFanSpd @@ 2950 I>F F/ 100 I>F F* ^fFanSpd @! 
14 LINE.NUM ^fFanSpd @@ 3 0 *sVar  FF.R$ 
15 LINE.NUM *sVar 12 {stDTdata $TABLE@  $MOVE 
16 LINE.NUM ~AI_TentIntakeFanM312_Tach @@ 60 I>F F* 3 I>F F/ ^fFanSpd @! 
17 LINE.NUM ^fFanSpd @@ 2950 I>F F/ 100 I>F F* ^fFanSpd @! 
18 LINE.NUM ^fFanSpd @@ 3 0 *sVar  FF.R$ 
19 LINE.NUM *sVar 13 {stDTdata $TABLE@  $MOVE 
21 LINE.NUM |pidTentFans  $0010.. ROT PID@ 4 1 *sVar  FF.R$ 
22 LINE.NUM *sVar 14 {stDTdata $TABLE@  $MOVE 
23 LINE.NUM |pidTentFans  $0020.. ROT PID@ 4 1 *sVar  FF.R$ 
24 LINE.NUM *sVar 15 {stDTdata $TABLE@  $MOVE 
25 LINE.NUM |pidTentFans  $0040.. ROT PID@ 4 1 *sVar  FF.R$ 
26 LINE.NUM *sVar 16 {stDTdata $TABLE@  $MOVE 
27 LINE.NUM |pidTentFans  $4000.. ROT PID@ 5 3 *sVar  FF.R$ 
28 LINE.NUM *sVar 17 {stDTdata $TABLE@  $MOVE 
30 LINE.NUM *LogCommHandle  OPEN DROP  
31 LINE.NUM *LogCommHandle  ?OPEN 0> IF 
32 LINE.NUM *LogCommHandle 32  S.!EOL 
33 LINE.NUM 21 0 {stDTdata *LogCommHandle  S.PUT#TABLE DROP  
34 LINE.NUM *CRLF *LogCommHandle  PRT$ DROP  
35 LINE.NUM *LogCommHandle  CLOSE DROP  
36 LINE.NUM ELSE 
37 LINE.NUM 1 ^WriteToLogFailedFlag @! 
38 LINE.NUM THEN 
39 LINE.NUM 0 ^DTlogFlag @! 
40 LINE.NUM THEN 
46 LINE.NUM *sTimestamp2 &Timestamp CALL.SUB DROP  
47 LINE.NUM *sTimestamp2 0 4 *sDate  $SUB 
48 LINE.NUM " -" *sDate $CAT 

49 LINE.NUM *sTimestamp2 5 2 *sMonth  $SUB 
50 LINE.NUM *sMonth *sDate $CAT 

51 LINE.NUM " -" *sDate $CAT 

52 LINE.NUM *sTimestamp2 8 2 *sDay  $SUB 
53 LINE.NUM *sDay *sDate $CAT 

59 LINE.NUM *sCurrentDate *sDate  $CMP 0 <> ^SendData @@ 1 = LOR  IF 
60 LINE.NUM *FTPcommHandle  OPEN DROP  
61 LINE.NUM *FTPcommHandle  ?OPEN 0> IF 
62 LINE.NUM " " *sFTPcmd  $MOVE 
63 LINE.NUM " appe:IglooData.txt" *sFTPcmd $CAT 

64 LINE.NUM " ," *sFTPcmd $CAT 

65 LINE.NUM *sCurrentDate *sFTPcmd $CAT 

66 LINE.NUM " _" *sFTPcmd $CAT 

67 LINE.NUM " IglooData.txt" *sFTPcmd $CAT 

69 LINE.NUM *sDate *sCurrentDate  $MOVE 
71 LINE.NUM *FTPcommHandle " cd:/iglooData"  SWAP COM.CMD DROP  
72 LINE.NUM *FTPcommHandle *sFTPcmd  SWAP COM.CMD DROP  
73 LINE.NUM *FTPcommHandle  CLOSE DROP  
76 LINE.NUM " file:w,IglooData.txt" *LogCommHandle  $MOVE 
77 LINE.NUM *LogCommHandle  OPEN DROP  
78 LINE.NUM *LogCommHandle  ?OPEN 0> IF 
79 LINE.NUM *LogCommHandle 32  S.!EOL 
80 LINE.NUM 21 0 {stHeader *LogCommHandle  S.PUT#TABLE DROP  
81 LINE.NUM *CRLF *LogCommHandle  PRT$ DROP  
82 LINE.NUM *LogCommHandle  CLOSE DROP  
83 LINE.NUM ELSE 
84 LINE.NUM 1 ^WriteToLogFailedFlag @! 
85 LINE.NUM THEN 
88 LINE.NUM " file:a,IglooData.txt" *LogCommHandle  $MOVE 
89 LINE.NUM 0 ^SendData @! 
90 LINE.NUM THEN 
91 LINE.NUM THEN 
97 LINE.NUM *sCurrentTime  TIME>$ 
98 LINE.NUM *sCurrentTime 0 5 *sCurrentTime  $SUB 
99 LINE.NUM *sCurrentTime " 12:00"  $CMP 0 = IF 
100 LINE.NUM *FTPcommHandle  OPEN DROP  
101 LINE.NUM *FTPcommHandle  ?OPEN 0> IF 
102 LINE.NUM " " *sFTPcmd  $MOVE 
103 LINE.NUM " appe:IglooData.txt" *sFTPcmd $CAT 

104 LINE.NUM " ," *sFTPcmd $CAT 

105 LINE.NUM *sDate *sFTPcmd $CAT 

106 LINE.NUM " _" *sFTPcmd $CAT 

107 LINE.NUM " IglooData.txt" *sFTPcmd $CAT 

110 LINE.NUM *FTPcommHandle " cd:/iglooData"  SWAP COM.CMD DROP  
111 LINE.NUM *FTPcommHandle *sFTPcmd  SWAP COM.CMD DROP  
112 LINE.NUM *FTPcommHandle  CLOSE DROP  
114 LINE.NUM " file:w,IglooData.txt" *LogCommHandle  $MOVE 
115 LINE.NUM *LogCommHandle  OPEN DROP  
116 LINE.NUM *LogCommHandle  CLOSE DROP  
117 LINE.NUM " file:a,IglooData.txt" *LogCommHandle  $MOVE 
118 LINE.NUM THEN 
119 LINE.NUM THEN 
8 JUMP ;
: 2_15
1 LINE.NUM 7 {stDTdata $TABLE@  $>F ^fPidInput @! 
2 LINE.NUM |pidTentFans ^fPidInput @@  $0001.. 3 ROLL !PID 
0 JUMP ;
: 2_18
4 LINE.NUM ~AI_Utility_Volt @@ 190 I>F F< ^Utility_Volt_WatchdogFlag @@ 0 = LAND  IF 
5 LINE.NUM 120 I>F ^dtAirCon_CR @! 
6 LINE.NUM 1 ^Utility_Volt_WatchdogFlag @! 
7 LINE.NUM THEN 
13 LINE.NUM ^dtAirCon_CR @@F 0 I>F F= ^AirConOffFlag @@ 0 = LAND  IF 
14 LINE.NUM 1 ~DO_AirCon_CR @! 
15 LINE.NUM 0 ^Utility_Volt_WatchdogFlag @! 
16 LINE.NUM ELSE 
16 LINE.NUM ^dtAirCon_CR @@F 0 I>F F> ^AirConOffFlag @@ 1 = LOR  IF 
17 LINE.NUM 0 ~DO_AirCon_CR @! 
18 LINE.NUM THEN THEN 
0 JUMP ;
: 2_21
1 LINE.NUM ~DI_NRES_Deadman  CLR.-LATCH@I ^CryoTigThermalTimer @@F 0 I>F F= LAND  IF 
2 LINE.NUM 300 I>F ^CryoTigThermalTimer @! 
3 LINE.NUM 1 ^DeadmanFlag @! 
4 LINE.NUM THEN 
6 LINE.NUM ~DI_NRES_Deadman @@I 1 = ^CryoTigThermalTimer @@F 0 I>F F= LAND  ^CryoTigOffFlag @@ 0 = LAND  IF 
7 LINE.NUM 1 ~DO_CryoTig_CR @! 
8 LINE.NUM ELSE 
9 LINE.NUM 0 ~DO_CryoTig_CR @! 
10 LINE.NUM THEN 
0 JUMP ;
: 2_24
1 LINE.NUM ~AI_P119_Temp @@ ^PanelTemp @! 
12 LINE.NUM ^PanelTemp @@ 20 I>F F>= ^PanelTemp @@ 30 I>F F<= LAND  IF 
13 LINE.NUM ^PanelFanMaxCtrl @@ 5 I>F F= IF 
14 LINE.NUM ^PanelFanMaxCtrl @@ 6.99999988e-001 F- 10 I>F F/ ^PanelTemp @@ F* 7.90000010e+000 F- ~AO_PanelFans_CTRL @! 
15 LINE.NUM ELSE 
15 LINE.NUM ^PanelFanMaxCtrl @@ 10 I>F F= IF 
16 LINE.NUM ^PanelFanMaxCtrl @@ 6.99999988e-001 F- 10 I>F F/ ^PanelTemp @@ F* 1.78999996e+001 F- ~AO_PanelFans_CTRL @! 
17 LINE.NUM THEN THEN 
18 LINE.NUM ELSE 
18 LINE.NUM ^PanelTemp @@ 20 I>F F< IF 
19 LINE.NUM 0 I>F ~AO_PanelFans_CTRL @! 
20 LINE.NUM ELSE 
20 LINE.NUM ^PanelTemp @@ 30 I>F F> IF 
21 LINE.NUM ^PanelFanMaxCtrl @@ ~AO_PanelFans_CTRL @! 
22 LINE.NUM THEN THEN THEN 
0 JUMP ;
: 2_27
9 LINE.NUM ^TentTempOK @@ 0 = ^IglooTempOK @@ 0 = LOR  IF 
10 LINE.NUM 1 ^IglooOverTemp @! 
11 LINE.NUM 300 I>F ^CryoTigThermalTimer @! 
12 LINE.NUM 1 ~DO_NRES_CR @! 
13 LINE.NUM |pidTentFans 1  $20000.. 3 ROLL !PID 
14 LINE.NUM |pidTentFans 0 I>F  $0008.. 3 ROLL !PID 
15 LINE.NUM 0 I>F ~AO_StirFans_CTRL @! 
16 LINE.NUM 0 I>F ~AO_TentStirFan_Ctrl @! 
17 LINE.NUM ELSE 
18 LINE.NUM 0 ^IglooOverTemp @! 
19 LINE.NUM THEN 
0 JUMP ;
: 2_30
5 LINE.NUM ^dtFanMonitor @@F 0 I>F F= IF 
7 LINE.NUM 10 I>F ^dtFanMonitor @! 
8 LINE.NUM ^dtFanMonitor  StartTimer 
10 LINE.NUM ^Old_AO_StirFansCTRL @@ ~AO_StirFans_CTRL @@ F= IF 
13 LINE.NUM 2950 1000 -  10 1 -  / I>F ~AO_StirFans_CTRL @@ F* 7.83333008e+002 F+ ^CalcFanSpd @! 
14 LINE.NUM ~AI_IglooStirFanM282_Tach @@ 60 I>F F* 3 I>F F/ ^FanSpd @! 
15 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
16 LINE.NUM 1 ^IglooStirFanM282_ErrorFlag @! 
17 LINE.NUM THEN 
21 LINE.NUM 2950 1000 -  10 1 -  / I>F ~AO_StirFans_CTRL @@ F* 7.83333008e+002 F+ ^CalcFanSpd @! 
22 LINE.NUM ~AI_IglooStirFanM284_Tach @@ 60 I>F F* 3 I>F F/ ^FanSpd @! 
23 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
24 LINE.NUM 1 ^IglooStirFanM284_ErrorFlag @! 
25 LINE.NUM THEN 
29 LINE.NUM 2950 1000 -  10 1 -  / I>F ~AO_StirFans_CTRL @@ F* 7.83333008e+002 F+ ^CalcFanSpd @! 
30 LINE.NUM ~AI_IglooStirFanM292_Tach @@ 60 I>F F* 3 I>F F/ ^FanSpd @! 
31 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
32 LINE.NUM 1 ^IglooStirFanM292_ErrorFlag @! 
33 LINE.NUM THEN 
37 LINE.NUM 2950 1000 -  10 1 -  / I>F ~AO_StirFans_CTRL @@ F* 7.83333008e+002 F+ ^CalcFanSpd @! 
38 LINE.NUM ~AI_IglooStirFanM294_Tach @@ 60 I>F F* 3 I>F F/ ^FanSpd @! 
39 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
40 LINE.NUM 1 ^IglooStirFanM294_ErrorFlag @! 
41 LINE.NUM THEN 
43 LINE.NUM ~AO_StirFans_CTRL @@ ^Old_AO_StirFansCTRL @! 
45 LINE.NUM THEN 
48 LINE.NUM ^Old_AO_TentServoFan_Ctrl @@ ~AO_TentServoFan_Ctrl @@ F= IF 
51 LINE.NUM 2950 1000 -  10 1 -  / I>F ~AO_TentServoFan_Ctrl @@ F* 7.83333008e+002 F+ ^CalcFanSpd @! 
52 LINE.NUM ~AI_TentIntakeFanM304_Tach @@ 60 I>F F* 3 I>F F/ ^FanSpd @! 
53 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
54 LINE.NUM 1 ^TentIntakeFanM304_ErrorFlag @! 
55 LINE.NUM THEN 
59 LINE.NUM 2950 1000 -  10 1 -  / I>F ~AO_TentServoFan_Ctrl @@ F* 7.83333008e+002 F+ ^CalcFanSpd @! 
60 LINE.NUM ~AI_TentExhaustFanM306_Tach @@ 60 I>F F* 3 I>F F/ ^FanSpd @! 
61 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
62 LINE.NUM 1 ^TentExhaustFanM306_ErrorFlag @! 
63 LINE.NUM THEN 
67 LINE.NUM 2950 1000 -  10 1 -  / I>F ~AO_TentServoFan_Ctrl @@ F* 7.83333008e+002 F+ ^CalcFanSpd @! 
68 LINE.NUM ~AI_TentIntakeFanM312_Tach @@ 60 I>F F* 3 I>F F/ ^FanSpd @! 
69 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
70 LINE.NUM 1 ^TentIntakeFanM312_ErrorFlag @! 
71 LINE.NUM THEN 
75 LINE.NUM 2950 1000 -  10 1 -  / I>F ~AO_TentServoFan_Ctrl @@ F* 7.83333008e+002 F+ ^CalcFanSpd @! 
76 LINE.NUM ~AI_TentExhaustFanM314_Tach @@ 60 I>F F* 3 I>F F/ ^FanSpd @! 
77 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
78 LINE.NUM 1 ^TentExhaustFanM314_ErrorFlag @! 
79 LINE.NUM THEN 
81 LINE.NUM ~AO_StirFans_CTRL @@ ^Old_AO_StirFansCTRL @! 
83 LINE.NUM THEN 
86 LINE.NUM ^Old_AO_PanelFans_CTRL @@ ~AO_PanelFans_CTRL @@ F= IF 
88 LINE.NUM ^PanelFanMaxCtrl @@ 5 I>F F= IF 
91 LINE.NUM 3400 1000 - I>F 5 I>F 6.99999988e-001 F- F/ ~AO_PanelFans_CTRL @@ F* 6.09302002e+002 F+ ^CalcFanSpd @! 
92 LINE.NUM ~AI_PanelFanM184_Tach @@ 60 I>F F* 2 I>F F/ ^FanSpd @! 
93 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
94 LINE.NUM 1 ^PanelFanM184_ErrorFlag @! 
95 LINE.NUM THEN 
99 LINE.NUM 3400 1000 - I>F 5 I>F 6.99999988e-001 F- F/ ~AO_PanelFans_CTRL @@ F* 6.09302002e+002 F+ ^CalcFanSpd @! 
100 LINE.NUM ~AI_PanelFanM186_Tach @@ 60 I>F F* 2 I>F F/ ^FanSpd @! 
101 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
102 LINE.NUM 1 ^PanelFanM186_ErrorFlag @! 
103 LINE.NUM THEN 
105 LINE.NUM THEN 
108 LINE.NUM ^PanelFanMaxCtrl @@ 10 I>F F= IF 
111 LINE.NUM 3400 1000 - I>F 10 I>F 6.99999988e-001 F- F/ ~AO_PanelFans_CTRL @@ F* 8.19354980e+002 F+ ^CalcFanSpd @! 
112 LINE.NUM ~AI_PanelFanM184_Tach @@ 60 I>F F* 2 I>F F/ ^FanSpd @! 
113 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
114 LINE.NUM 1 ^PanelFanM184_ErrorFlag @! 
115 LINE.NUM THEN 
119 LINE.NUM 3400 1000 - I>F 10 I>F 6.99999988e-001 F- F/ ~AO_PanelFans_CTRL @@ F* 8.19354980e+002 F+ ^CalcFanSpd @! 
120 LINE.NUM ~AI_PanelFanM186_Tach @@ 60 I>F F* 2 I>F F/ ^FanSpd @! 
121 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
122 LINE.NUM 1 ^PanelFanM186_ErrorFlag @! 
123 LINE.NUM THEN 
125 LINE.NUM THEN 
127 LINE.NUM ~AO_PanelFans_CTRL @@ ^Old_AO_PanelFans_CTRL @! 
129 LINE.NUM THEN 
132 LINE.NUM ^Old_AO_TentStirFan_Ctrl @@ ~AO_TentStirFan_Ctrl @@ F= IF 
134 LINE.NUM ^TentStirFanMaxCtrl @@ 5 I>F F= IF 
137 LINE.NUM 3400 1000 - I>F 5 I>F 6.99999988e-001 F- F/ ~AO_TentStirFan_Ctrl @@ F* 6.09302002e+002 F+ ^CalcFanSpd @! 
138 LINE.NUM ~AI_TentStirFanM323_Tach @@ 60 I>F F* 2 I>F F/ ^FanSpd @! 
139 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
140 LINE.NUM 1 ^TentStirFanM323_ErrorFlag @! 
141 LINE.NUM THEN 
145 LINE.NUM 3400 1000 - I>F 5 I>F 6.99999988e-001 F- F/ ~AO_TentStirFan_Ctrl @@ F* 6.09302002e+002 F+ ^CalcFanSpd @! 
146 LINE.NUM ~AI_TentStirFanM325_Tach @@ 60 I>F F* 2 I>F F/ ^FanSpd @! 
147 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
148 LINE.NUM 1 ^TentStirFanM325_ErrorFlag @! 
149 LINE.NUM THEN 
151 LINE.NUM THEN 
154 LINE.NUM ^TentStirFanMaxCtrl @@ 10 I>F F= IF 
157 LINE.NUM 3400 1000 - I>F 10 I>F 6.99999988e-001 F- F/ ~AO_TentStirFan_Ctrl @@ F* 8.19354980e+002 F+ ^CalcFanSpd @! 
158 LINE.NUM ~AI_TentStirFanM323_Tach @@ 60 I>F F* 2 I>F F/ ^FanSpd @! 
159 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
160 LINE.NUM 1 ^TentStirFanM323_ErrorFlag @! 
161 LINE.NUM THEN 
165 LINE.NUM 3400 1000 - I>F 10 I>F 6.99999988e-001 F- F/ ~AO_TentStirFan_Ctrl @@ F* 8.19354980e+002 F+ ^CalcFanSpd @! 
166 LINE.NUM ~AI_TentStirFanM325_Tach @@ 60 I>F F* 2 I>F F/ ^FanSpd @! 
167 LINE.NUM ^FanSpd @@ ^CalcFanSpd @@ 1.10000002e+000 F* F> ^FanSpd @@ ^CalcFanSpd @@ 8.99999976e-001 F* F< LOR  IF 
168 LINE.NUM 1 ^TentStirFanM325_ErrorFlag @! 
169 LINE.NUM THEN 
171 LINE.NUM THEN 
173 LINE.NUM ~AO_TentStirFan_Ctrl @@ ^Old_AO_TentStirFan_Ctrl @! 
175 LINE.NUM THEN 
177 LINE.NUM THEN 
0 JUMP ;
: 2_35
5 LINE.NUM ^EcbResetFlag @@ 1 = IF 
6 LINE.NUM 6.00000024e-001 ~DO_ECB_Tx  PULSEON 
7 LINE.NUM 0 ^EcbResetFlag @! 
8 LINE.NUM 1000  DELAY 
9 LINE.NUM THEN 
21 LINE.NUM ^MasterEcbFlag @@ 1 = IF 
22 LINE.NUM ^MasterEcbCmd @@ ^EcbCmd @! 
23 LINE.NUM 0 ^MasterEcbFlag @! 
24 LINE.NUM THEN 
26 LINE.NUM 15 ^Count @! 
27 LINE.NUM 1 ^x @! 
30 LINE.NUM 1 ~DO_ECB_Tx @! 
31 LINE.NUM 3.50000001e-002 ^Preset @! 
32 LINE.NUM ^Preset @@ ^Timer @! 
33 LINE.NUM BEGIN ^x @@ WHILE 
34 LINE.NUM ^Timer  T0= IF 
35 LINE.NUM 0 ~DO_ECB_Tx @! 
36 LINE.NUM ^Preset @@ ^Timer @! 
37 LINE.NUM 0 ^x @! 
38 LINE.NUM THEN 
39 LINE.NUM REPEAT 
40 LINE.NUM 1 ^x @! 
41 LINE.NUM BEGIN ^x @@ WHILE 
42 LINE.NUM ^Timer  T0= IF 
43 LINE.NUM 0 ^x @! 
44 LINE.NUM THEN 
45 LINE.NUM REPEAT 
46 LINE.NUM 1 ^x @! 
49 LINE.NUM BEGIN ^Count @@ -1 > WHILE 
50 LINE.NUM ^EcbCmd @@ ^Count @@  BitTest IF 
52 LINE.NUM 0 ~DO_ECB_Tx @! 
53 LINE.NUM ^Preset @@ ^Timer @! 
54 LINE.NUM BEGIN ^x @@ WHILE 
55 LINE.NUM ^Timer  T0= IF 
56 LINE.NUM 1 ~DO_ECB_Tx @! 
57 LINE.NUM ^Preset @@ ^Timer @! 
58 LINE.NUM 0 ^x @! 
60 LINE.NUM ~DI_ECB_Rx @@I ^Count @@ }EcbBitData TABLE! 
61 LINE.NUM THEN 
62 LINE.NUM REPEAT 
63 LINE.NUM 1 ^x @! 
64 LINE.NUM BEGIN ^x @@ WHILE 
65 LINE.NUM ^Timer  T0= IF 
66 LINE.NUM 0 ^x @! 
67 LINE.NUM THEN 
68 LINE.NUM REPEAT 
69 LINE.NUM 1 ^x @! 
70 LINE.NUM ELSE 
72 LINE.NUM 1 ~DO_ECB_Tx @! 
73 LINE.NUM ^Preset @@ ^Timer @! 
74 LINE.NUM BEGIN ^x @@ WHILE 
75 LINE.NUM ^Timer  T0= IF 
76 LINE.NUM 0 ~DO_ECB_Tx @! 
77 LINE.NUM ^Preset @@ ^Timer @! 
78 LINE.NUM 0 ^x @! 
80 LINE.NUM ~DI_ECB_Rx @@I ^Count @@ }EcbBitData TABLE! 
81 LINE.NUM THEN 
82 LINE.NUM REPEAT 
83 LINE.NUM 1 ^x @! 
84 LINE.NUM BEGIN ^x @@ WHILE 
85 LINE.NUM ^Timer  T0= IF 
86 LINE.NUM 0 ^x @! 
87 LINE.NUM THEN 
88 LINE.NUM REPEAT 
89 LINE.NUM 1 ^x @! 
90 LINE.NUM THEN 
91 LINE.NUM ^Count @@ 1 -  ^Count @! 
93 LINE.NUM REPEAT 
96 LINE.NUM 0 ~DO_ECB_Tx @! 
99 LINE.NUM ^EcbCmd @@ 32 <> IF 
100 LINE.NUM 32 ^EcbCmd @! 
101 LINE.NUM THEN 
127 LINE.NUM 15 ^Count @! 
128 LINE.NUM BEGIN ^Count @@ 7 > WHILE 
129 LINE.NUM ^Count @@ }EcbBitData TABLE@ IF 
130 LINE.NUM 2 ^Count @@ 8 -  }EcbStatus TABLE! 
131 LINE.NUM ELSE 
131 LINE.NUM ^Count @@ }EcbBitData TABLE@ 0 = ^Count @@ 8 -  }EcbBitData TABLE@ 0 = LAND  IF 
132 LINE.NUM 0 ^Count @@ 8 -  }EcbStatus TABLE! 
133 LINE.NUM ELSE 
133 LINE.NUM ^Count @@ }EcbBitData TABLE@ 0 = ^Count @@ 8 -  }EcbBitData TABLE@ 1 = LAND  IF 
134 LINE.NUM 1 ^Count @@ 8 -  }EcbStatus TABLE! 
135 LINE.NUM THEN THEN THEN 
136 LINE.NUM ^Count @@ 1 -  ^Count @! 
137 LINE.NUM REPEAT 
-10 JUMP ;
: 2_40
24 LINE.NUM 1 ^Count3 @! 
25 LINE.NUM " " *sNewLog  $MOVE 
26 LINE.NUM BEGIN ^Count3 @@ 9 < WHILE 
27 LINE.NUM ^Count3 @@ {stModbusData $TABLE@ *sNewLog $CAT 

28 LINE.NUM "  " *sNewLog $CAT 

29 LINE.NUM ^Count3 @@ 1 +  ^Count3 @! 
30 LINE.NUM REPEAT 
32 LINE.NUM ~AI_CA_SupplyPressure @@ 7 2 *sVar1  FF.R$ 
33 LINE.NUM *sVar1 3  SWAP $TRIM 
34 LINE.NUM *sVar1 *sNewLog $CAT 

36 LINE.NUM *sNewLog *sLog  $MOVE 
-8 JUMP ;
T: T2
DUMMY
2_0
2_1
2_2
2_6
2_8
2_15
2_18
2_21
2_24
2_27
2_30
2_35
2_40
T;
&Housekeeper ' T2 SETTASK
: 4_0
0 JUMP ;
: 4_2

1 LINE.NUM
  *cPort   LISTEN
  ^nPortStatus @! 
13 JUMP ;
: 4_6

1 LINE.NUM
  10    DELAY
-2 JUMP ;
: 4_9

1 LINE.NUM
  *cPort   ACCEPT
  ^nPortStatus @! 
12 JUMP ;
: 4_13

1 LINE.NUM
  10    DELAY
-2 JUMP ;
: 4_17
1 LINE.NUM 120 I>F ^dtSocket @! 
2 LINE.NUM ^dtSocket  StartTimer 
0 JUMP ;
: 4_19

1 LINE.NUM
  *cPort   ?STREAM.KEY
  ^nCharCount @! 
10 JUMP ;
: 4_28

1 LINE.NUM
  10    DELAY
-2 JUMP ;
: 4_37

1 LINE.NUM
  *cPort   STREAM.CLEAR.BUF

2 LINE.NUM
  *cPort   CLOSE
  ^nPortStatus @! 
-8 JUMP ;
: 4_43
1 LINE.NUM 120 I>F ^dtSocket @! 
2 LINE.NUM ^dtSocket  StartTimer 
12 JUMP ;
: 4_49
1 LINE.NUM *sCmd *cPort  GET$ ^nReceiveStatus @! 
2 LINE.NUM *sCmd  $>Upper 
3 LINE.NUM 0 ^nIndex @! 
12 JUMP ;
: 4_55

1 LINE.NUM
  *cPort   STREAM.CLEAR.BUF
1 JUMP ;
: 4_59
-7 JUMP ;
: 4_64
1 LINE.NUM " IGLOO_STIR_FANS_SPD" 0 *sCmd  FindSubString ^nFindCmd @! 
2 LINE.NUM ^nFindCmd @@ -1 > IF 
3 LINE.NUM ^IglooOverTemp @@ 0 = IF 
4 LINE.NUM *sCmd ^nFindCmd @@ 20 +  3 *sStirFansSpd  $SUB 
5 LINE.NUM *sStirFansSpd  $>I ^FanCtrl @! 
6 LINE.NUM ^FanCtrl @@ 0 = IF 
7 LINE.NUM 0 I>F ~AO_StirFans_CTRL @! 
8 LINE.NUM " Success=TRUE" *Status  $MOVE 
10 LINE.NUM " file:w,/sdcard0/stirfans.txt" *ch_SDcard  $MOVE 
11 LINE.NUM *ch_SDcard  OPEN DROP  
12 LINE.NUM *ch_SDcard  ?OPEN 0> IF 
13 LINE.NUM " ," *sStirFansSpd $CAT 

14 LINE.NUM *sStirFansSpd 3  SWAP $TRIM 
15 LINE.NUM *sStirFansSpd *ch_SDcard  PRT$ DROP  
16 LINE.NUM *ch_SDcard  CLOSE DROP  
17 LINE.NUM ELSE 
19 LINE.NUM THEN 
21 LINE.NUM ELSE 
21 LINE.NUM ^FanCtrl @@ 0 > ^FanCtrl @@ 100 <= LAND  IF 
23 LINE.NUM 9.08999965e-002 ^FanCtrl @@F F* 9.08999979e-001 F+ ^fFanCtrl @! 
24 LINE.NUM ^fFanCtrl @@ ~AO_StirFans_CTRL @! 
25 LINE.NUM " Success=TRUE" *Status  $MOVE 
27 LINE.NUM " file:w,/sdcard0/stirfans.txt" *ch_SDcard  $MOVE 
28 LINE.NUM *ch_SDcard  OPEN DROP  
29 LINE.NUM *ch_SDcard  ?OPEN 0> IF 
30 LINE.NUM ^fFanCtrl @@ 5 2 *sStirFansSpd  FF.R$ 
31 LINE.NUM " ," *sStirFansSpd $CAT 

32 LINE.NUM *sStirFansSpd 3  SWAP $TRIM 
33 LINE.NUM *sStirFansSpd *ch_SDcard  PRT$ DROP  
34 LINE.NUM *ch_SDcard  CLOSE DROP  
35 LINE.NUM ELSE 
37 LINE.NUM THEN 
39 LINE.NUM ELSE 
39 LINE.NUM ^FanCtrl @@ 100 > IF 
40 LINE.NUM " Success=FALSE, enter a value from 0 to 100" *Status  $MOVE 
41 LINE.NUM THEN THEN THEN 
42 LINE.NUM ELSE 
43 LINE.NUM " Success=FALSE, IglooOverTemp" *Status  $MOVE 
44 LINE.NUM THEN 
45 LINE.NUM THEN 
48 LINE.NUM " TENT_SERVO_FANS_AUTO" 0 *sCmd  FindSubString ^nFindCmd @! 
49 LINE.NUM ^nFindCmd @@ -1 > IF 
50 LINE.NUM ^IglooOverTemp @@ 0 = IF 
51 LINE.NUM |pidTentFans 0  $20000.. 3 ROLL !PID 
52 LINE.NUM " Success=TRUE" *Status  $MOVE 
53 LINE.NUM ELSE 
54 LINE.NUM " Success=FALSE, IglooOverTemp" *Status  $MOVE 
55 LINE.NUM THEN 
56 LINE.NUM THEN 
59 LINE.NUM " TENT_SERVO_FANS_MAN" 0 *sCmd  FindSubString ^nFindCmd @! 
60 LINE.NUM ^nFindCmd @@ -1 > IF 
61 LINE.NUM |pidTentFans 1  $20000.. 3 ROLL !PID 
62 LINE.NUM " Success=TRUE" *Status  $MOVE 
63 LINE.NUM THEN 
66 LINE.NUM " TENT_SERVO_FANS_SETPOINT" 0 *sCmd  FindSubString ^nFindCmd @! 
67 LINE.NUM ^nFindCmd @@ -1 > IF 
68 LINE.NUM *sCmd ^nFindCmd @@ 25 +  4 *sPidSetpoint  $SUB 
69 LINE.NUM *sPidSetpoint  $>F ^PidSetpoint @! 
70 LINE.NUM ^PidSetpoint @@ 1.00000000e+001 F< ^PidSetpoint @@ 3.50000000e+001 F> LOR  IF 
71 LINE.NUM " Success=FALSE, enter a value from 10.0 and 35.0" *Status  $MOVE 
72 LINE.NUM ELSE 
73 LINE.NUM |pidTentFans ^PidSetpoint @@  $0002.. 3 ROLL !PID 
74 LINE.NUM " Success=TRUE" *Status  $MOVE 
76 LINE.NUM " file:w,/sdcard0/setpoint.txt" *ch_SDcard  $MOVE 
77 LINE.NUM *ch_SDcard  OPEN DROP  
78 LINE.NUM *ch_SDcard  ?OPEN 0> IF 
81 LINE.NUM " ," *sPidSetpoint $CAT 

82 LINE.NUM *sPidSetpoint 3  SWAP $TRIM 
83 LINE.NUM *sPidSetpoint *ch_SDcard  PRT$ DROP  
84 LINE.NUM *ch_SDcard  CLOSE DROP  
85 LINE.NUM ELSE 
87 LINE.NUM THEN 
89 LINE.NUM THEN 
90 LINE.NUM THEN 
93 LINE.NUM " TENT_SERVO_FANS_SPD" 0 *sCmd  FindSubString ^nFindCmd @! 
94 LINE.NUM ^nFindCmd @@ -1 > IF 
95 LINE.NUM |pidTentFans  $20000.. ROT PID@ 0 = IF 
96 LINE.NUM " Success=FALSE, PID in AUTO" *Status  $MOVE 
97 LINE.NUM ELSE 
97 LINE.NUM ^IglooOverTemp @@ 1 = IF 
98 LINE.NUM " Success=FALSE, IglooOverTemp" *Status  $MOVE 
99 LINE.NUM ELSE 
99 LINE.NUM |pidTentFans  $20000.. ROT PID@ 1 = ^IglooOverTemp @@ 0 = LAND  IF 
100 LINE.NUM *sCmd ^nFindCmd @@ 20 +  3 *sTentFansSpd  $SUB 
101 LINE.NUM *sTentFansSpd  $>I ^FanCtrl @! 
102 LINE.NUM ^FanCtrl @@ 0 = IF 
103 LINE.NUM |pidTentFans ^FanCtrl @@F  $0008.. 3 ROLL !PID 
104 LINE.NUM " Success=TRUE" *Status  $MOVE 
105 LINE.NUM ELSE 
105 LINE.NUM ^FanCtrl @@ 0 > ^FanCtrl @@ 100 <= LAND  IF 
107 LINE.NUM 4.09100018e-002 ^FanCtrl @@F F* 9.08999979e-001 F+ ^FanCtrl F@! 
108 LINE.NUM |pidTentFans ^FanCtrl @@F  $0008.. 3 ROLL !PID 
109 LINE.NUM " Success=TRUE" *Status  $MOVE 
110 LINE.NUM ELSE 
110 LINE.NUM ^FanCtrl @@ 100 > IF 
111 LINE.NUM " Success=FALSE, enter a value from 0 to 100" *Status  $MOVE 
112 LINE.NUM THEN THEN THEN 
113 LINE.NUM THEN THEN THEN 
114 LINE.NUM THEN 
117 LINE.NUM " TENT_STIR_FANS_SPD" 0 *sCmd  FindSubString ^nFindCmd @! 
118 LINE.NUM ^nFindCmd @@ -1 > IF 
119 LINE.NUM ^IglooOverTemp @@ 0 = IF 
120 LINE.NUM *sCmd ^nFindCmd @@ 19 +  3 *sStirFansSpd  $SUB 
121 LINE.NUM *sStirFansSpd  $>I ^FanCtrl @! 
122 LINE.NUM ^FanCtrl @@ 0 = IF 
123 LINE.NUM 0 I>F ~AO_TentStirFan_Ctrl @! 
124 LINE.NUM " Success=TRUE" *Status  $MOVE 
125 LINE.NUM ELSE 
125 LINE.NUM ^FanCtrl @@ 0 >= ^FanCtrl @@ 100 <= LAND  IF 
126 LINE.NUM ^TentStirFanMaxCtrl @@ 5 I>F F= IF 
127 LINE.NUM ^TentStirFanMaxCtrl @@ 6.99999988e-001 F- 100 1 - I>F F/ 100 I>F F* 6.57000005e-001 F+ ~AO_TentStirFan_Ctrl @! 
128 LINE.NUM ELSE 
128 LINE.NUM ^TentStirFanMaxCtrl @@ 10 I>F F= IF 
129 LINE.NUM ^TentStirFanMaxCtrl @@ 6.99999988e-001 F- 100 1 - I>F F/ 100 I>F F* 6.06000006e-001 F+ ~AO_TentStirFan_Ctrl @! 
130 LINE.NUM THEN THEN 
131 LINE.NUM " Success=TRUE" *Status  $MOVE 
132 LINE.NUM ELSE 
132 LINE.NUM ^FanCtrl @@ 100 > IF 
133 LINE.NUM " Success=FALSE, enter a value from 0 to 100" *Status  $MOVE 
134 LINE.NUM THEN THEN THEN 
135 LINE.NUM ELSE 
136 LINE.NUM " Success=FALSE, IglooOverTemp" *Status  $MOVE 
137 LINE.NUM THEN 
138 LINE.NUM THEN 
141 LINE.NUM " CRYOTIGER_ON" 0 *sCmd  FindSubString ^nFindCmd @! 
142 LINE.NUM ^nFindCmd @@ -1 > IF 
143 LINE.NUM ~DI_NRES_Deadman @@I 1 = ^CryoTigThermalTimer @@F 0 I>F F= LAND  IF 
144 LINE.NUM 1 ~DO_CryoTig_CR @! 
145 LINE.NUM 0 ^CryoTigOffFlag @! 
146 LINE.NUM " Success=TRUE" *Status  $MOVE 
147 LINE.NUM ELSE 
148 LINE.NUM 0 ~DO_CryoTig_CR @! 
149 LINE.NUM " Success=FALSE" *Status  $MOVE 
150 LINE.NUM ^IglooOverTemp @@ 1 = IF 
151 LINE.NUM " , IglooOverTemp" *Status $CAT 

152 LINE.NUM ELSE 
152 LINE.NUM ^CryoTigThermalTimer @@F 0 I>F F> IF 
153 LINE.NUM " , CryoTiger cooldown timer = " *Status $CAT 

154 LINE.NUM ^CryoTigThermalTimer @@F *sCryoTigThermalTimer  F>$ 
155 LINE.NUM *sCryoTigThermalTimer *Status $CAT 

156 LINE.NUM ELSE 
156 LINE.NUM ~DI_NRES_Deadman @@I 0 = IF 
157 LINE.NUM " , NRES deadman disabled" *Status $CAT 

158 LINE.NUM THEN THEN THEN 
159 LINE.NUM THEN 
160 LINE.NUM THEN 
163 LINE.NUM " CRYOTIGER_OFF" 0 *sCmd  FindSubString ^nFindCmd @! 
164 LINE.NUM ^nFindCmd @@ -1 > IF 
165 LINE.NUM 0 ~DO_CryoTig_CR @! 
166 LINE.NUM 200  DELAY 
167 LINE.NUM ~DI_CryoTig_CR_NC @@I IF 
168 LINE.NUM " Success=TRUE" *Status  $MOVE 
169 LINE.NUM 300 I>F ^CryoTigThermalTimer @! 
170 LINE.NUM 1 ^CryoTigOffFlag @! 
171 LINE.NUM ELSE 
172 LINE.NUM " Success=FALSE" *Status  $MOVE 
173 LINE.NUM 1 ^Cryotig_CR_ErrorFlag @! 
174 LINE.NUM THEN 
175 LINE.NUM THEN 
178 LINE.NUM " DATATAKER_COMM_ON" 0 *sCmd  FindSubString ^nFindCmd @! 
179 LINE.NUM ^nFindCmd @@ -1 > IF 
180 LINE.NUM &DatatakerComm  START.T DROP  
181 LINE.NUM " Success=TRUE" *Status  $MOVE 
182 LINE.NUM THEN 
185 LINE.NUM " DATATAKER_COMM_OFF" 0 *sCmd  FindSubString ^nFindCmd @! 
186 LINE.NUM ^nFindCmd @@ -1 > IF 
187 LINE.NUM &DatatakerComm  STOP.T 
188 LINE.NUM *DTcommHandle  CLOSE DROP  
189 LINE.NUM " Success=TRUE" *Status  $MOVE 
190 LINE.NUM THEN 
193 LINE.NUM " AIRCON_ON" 0 *sCmd  FindSubString ^nFindCmd @! 
194 LINE.NUM ^nFindCmd @@ -1 > IF 
195 LINE.NUM ~DO_AirCon_CR @@I 1 = IF 
196 LINE.NUM " Success=TRUE" *Status  $MOVE 
197 LINE.NUM ELSE 
197 LINE.NUM ~DO_AirCon_CR @@I 0 = IF 
198 LINE.NUM 120 I>F ^dtAirCon_CR @! 
199 LINE.NUM " Success=TRUE, Turn-On in 120sec" *Status  $MOVE 
200 LINE.NUM THEN THEN 
201 LINE.NUM 0 ^AirConOffFlag @! 
202 LINE.NUM THEN 
205 LINE.NUM " AIRCON_OFF" 0 *sCmd  FindSubString ^nFindCmd @! 
206 LINE.NUM ^nFindCmd @@ -1 > IF 
207 LINE.NUM 1 ^AirConOffFlag @! 
208 LINE.NUM 200  DELAY 
209 LINE.NUM ~DI_AirCon_CR_NC @@I IF 
210 LINE.NUM " Success=TRUE" *Status  $MOVE 
211 LINE.NUM ELSE 
212 LINE.NUM " Success=FALSE" *Status  $MOVE 
213 LINE.NUM 1 ^AirCon_CR_ErrorFlag @! 
214 LINE.NUM THEN 
215 LINE.NUM THEN 
218 LINE.NUM " NRES_ON" 0 *sCmd  FindSubString ^nFindCmd @! 
219 LINE.NUM ^nFindCmd @@ -1 > IF 
220 LINE.NUM ^IglooOverTemp @@ 0 = IF 
221 LINE.NUM 0 ~DO_NRES_CR @! 
222 LINE.NUM " Success=TRUE" *Status  $MOVE 
223 LINE.NUM ELSE 
224 LINE.NUM " Success=FALSE, IglooOverTemp" *Status  $MOVE 
225 LINE.NUM THEN 
226 LINE.NUM THEN 
229 LINE.NUM " NRES_OFF" 0 *sCmd  FindSubString ^nFindCmd @! 
230 LINE.NUM ^nFindCmd @@ -1 > IF 
231 LINE.NUM 1 ~DO_NRES_CR @! 
232 LINE.NUM 200  DELAY 
233 LINE.NUM ~DI_NRES_CR_NO @@I IF 
234 LINE.NUM " Success=TRUE" *Status  $MOVE 
235 LINE.NUM ELSE 
236 LINE.NUM " Success=FALSE" *Status  $MOVE 
237 LINE.NUM 1 ^NRES_CR_ErrorFlag @! 
238 LINE.NUM THEN 
239 LINE.NUM THEN 
288 LINE.NUM " MCB_24V_RESET" 0 *sCmd  FindSubString ^nFindCmd @! 
289 LINE.NUM ^nFindCmd @@ -1 > IF 
290 LINE.NUM 1 ^EcbResetFlag @! 
291 LINE.NUM " Success=TRUE" *Status  $MOVE 
292 LINE.NUM THEN 
314 LINE.NUM " MCB_DATATAKER_ON" 0 *sCmd  FindSubString ^nFindCmd @! 
315 LINE.NUM ^nFindCmd @@ -1 > IF 
316 LINE.NUM }EcbBitData 0 }ntEcbCmd 0 16  CopyTable  
317 LINE.NUM 1 10 }ntEcbCmd TABLE! 
318 LINE.NUM 1 7 }ntEcbCmd TABLE! 
319 LINE.NUM 0 ^MasterEcbCmd @! 
320 LINE.NUM 15 ^Count1 @! 
322 LINE.NUM BEGIN ^Count1 @@ -1 > WHILE 
323 LINE.NUM ^Count1 @@ }ntEcbCmd TABLE@ 1 = IF 
324 LINE.NUM ^MasterEcbCmd @@F 2 I>F ^Count1 @@F  F^ F+ ^MasterEcbCmd F@! 
325 LINE.NUM THEN 
326 LINE.NUM ^Count1 @@ 1 -  ^Count1 @! 
327 LINE.NUM REPEAT 
328 LINE.NUM 1 ^MasterEcbFlag @! 
329 LINE.NUM " Success=TRUE" *Status  $MOVE 
330 LINE.NUM THEN 
333 LINE.NUM " MCB_DATATAKER_OFF" 0 *sCmd  FindSubString ^nFindCmd @! 
334 LINE.NUM ^nFindCmd @@ -1 > IF 
335 LINE.NUM }EcbBitData 0 }ntEcbCmd 0 16  CopyTable  
336 LINE.NUM 0 10 }ntEcbCmd TABLE! 
337 LINE.NUM 1 7 }ntEcbCmd TABLE! 
338 LINE.NUM 0 ^MasterEcbCmd @! 
339 LINE.NUM 15 ^Count1 @! 
341 LINE.NUM BEGIN ^Count1 @@ -1 > WHILE 
342 LINE.NUM ^Count1 @@ }ntEcbCmd TABLE@ 1 = IF 
343 LINE.NUM ^MasterEcbCmd @@F 2 I>F ^Count1 @@F  F^ F+ ^MasterEcbCmd F@! 
344 LINE.NUM THEN 
345 LINE.NUM ^Count1 @@ 1 -  ^Count1 @! 
346 LINE.NUM REPEAT 
347 LINE.NUM 1 ^MasterEcbFlag @! 
348 LINE.NUM " Success=TRUE" *Status  $MOVE 
349 LINE.NUM THEN 
352 LINE.NUM " MCB_STIRFANS1_ON" 0 *sCmd  FindSubString ^nFindCmd @! 
353 LINE.NUM ^nFindCmd @@ -1 > IF 
354 LINE.NUM }EcbBitData 0 }ntEcbCmd 0 16  CopyTable  
355 LINE.NUM 1 11 }ntEcbCmd TABLE! 
356 LINE.NUM 1 7 }ntEcbCmd TABLE! 
357 LINE.NUM 0 ^MasterEcbCmd @! 
358 LINE.NUM 15 ^Count1 @! 
360 LINE.NUM BEGIN ^Count1 @@ -1 > WHILE 
361 LINE.NUM ^Count1 @@ }ntEcbCmd TABLE@ 1 = IF 
362 LINE.NUM ^MasterEcbCmd @@F 2 I>F ^Count1 @@F  F^ F+ ^MasterEcbCmd F@! 
363 LINE.NUM THEN 
364 LINE.NUM ^Count1 @@ 1 -  ^Count1 @! 
365 LINE.NUM REPEAT 
366 LINE.NUM 1 ^MasterEcbFlag @! 
367 LINE.NUM " Success=TRUE" *Status  $MOVE 
368 LINE.NUM THEN 
371 LINE.NUM " MCB_STIRFANS1_OFF" 0 *sCmd  FindSubString ^nFindCmd @! 
372 LINE.NUM ^nFindCmd @@ -1 > IF 
373 LINE.NUM }EcbBitData 0 }ntEcbCmd 0 16  CopyTable  
374 LINE.NUM 0 11 }ntEcbCmd TABLE! 
375 LINE.NUM 1 7 }ntEcbCmd TABLE! 
376 LINE.NUM 0 ^MasterEcbCmd @! 
377 LINE.NUM 15 ^Count1 @! 
379 LINE.NUM BEGIN ^Count1 @@ -1 > WHILE 
380 LINE.NUM ^Count1 @@ }ntEcbCmd TABLE@ 1 = IF 
381 LINE.NUM ^MasterEcbCmd @@F 2 I>F ^Count1 @@F  F^ F+ ^MasterEcbCmd F@! 
382 LINE.NUM THEN 
383 LINE.NUM ^Count1 @@ 1 -  ^Count1 @! 
384 LINE.NUM REPEAT 
385 LINE.NUM 1 ^MasterEcbFlag @! 
386 LINE.NUM " Success=TRUE" *Status  $MOVE 
387 LINE.NUM THEN 
390 LINE.NUM " MCB_STIRFANS2_ON" 0 *sCmd  FindSubString ^nFindCmd @! 
391 LINE.NUM ^nFindCmd @@ -1 > IF 
392 LINE.NUM }EcbBitData 0 }ntEcbCmd 0 16  CopyTable  
393 LINE.NUM 1 12 }ntEcbCmd TABLE! 
394 LINE.NUM 1 7 }ntEcbCmd TABLE! 
395 LINE.NUM 0 ^MasterEcbCmd @! 
396 LINE.NUM 15 ^Count1 @! 
398 LINE.NUM BEGIN ^Count1 @@ -1 > WHILE 
399 LINE.NUM ^Count1 @@ }ntEcbCmd TABLE@ 1 = IF 
400 LINE.NUM ^MasterEcbCmd @@F 2 I>F ^Count1 @@F  F^ F+ ^MasterEcbCmd F@! 
401 LINE.NUM THEN 
402 LINE.NUM ^Count1 @@ 1 -  ^Count1 @! 
403 LINE.NUM REPEAT 
404 LINE.NUM 1 ^MasterEcbFlag @! 
405 LINE.NUM " Success=TRUE" *Status  $MOVE 
406 LINE.NUM THEN 
409 LINE.NUM " MCB_STIRFANS2_OFF" 0 *sCmd  FindSubString ^nFindCmd @! 
410 LINE.NUM ^nFindCmd @@ -1 > IF 
411 LINE.NUM }EcbBitData 0 }ntEcbCmd 0 16  CopyTable  
412 LINE.NUM 0 12 }ntEcbCmd TABLE! 
413 LINE.NUM 1 7 }ntEcbCmd TABLE! 
414 LINE.NUM 0 ^MasterEcbCmd @! 
415 LINE.NUM 15 ^Count1 @! 
417 LINE.NUM BEGIN ^Count1 @@ -1 > WHILE 
418 LINE.NUM ^Count1 @@ }ntEcbCmd TABLE@ 1 = IF 
419 LINE.NUM ^MasterEcbCmd @@F 2 I>F ^Count1 @@F  F^ F+ ^MasterEcbCmd F@! 
420 LINE.NUM THEN 
421 LINE.NUM ^Count1 @@ 1 -  ^Count1 @! 
422 LINE.NUM REPEAT 
423 LINE.NUM 1 ^MasterEcbFlag @! 
424 LINE.NUM " Success=TRUE" *Status  $MOVE 
425 LINE.NUM THEN 
428 LINE.NUM " MCB_SERVOFANS1_ON" 0 *sCmd  FindSubString ^nFindCmd @! 
429 LINE.NUM ^nFindCmd @@ -1 > IF 
430 LINE.NUM }EcbBitData 0 }ntEcbCmd 0 16  CopyTable  
431 LINE.NUM 1 13 }ntEcbCmd TABLE! 
432 LINE.NUM 1 7 }ntEcbCmd TABLE! 
433 LINE.NUM 0 ^MasterEcbCmd @! 
434 LINE.NUM 15 ^Count1 @! 
436 LINE.NUM BEGIN ^Count1 @@ -1 > WHILE 
437 LINE.NUM ^Count1 @@ }ntEcbCmd TABLE@ 1 = IF 
438 LINE.NUM ^MasterEcbCmd @@F 2 I>F ^Count1 @@F  F^ F+ ^MasterEcbCmd F@! 
439 LINE.NUM THEN 
440 LINE.NUM ^Count1 @@ 1 -  ^Count1 @! 
441 LINE.NUM REPEAT 
442 LINE.NUM 1 ^MasterEcbFlag @! 
443 LINE.NUM " Success=TRUE" *Status  $MOVE 
444 LINE.NUM THEN 
447 LINE.NUM " MCB_SERVOFANS1_OFF" 0 *sCmd  FindSubString ^nFindCmd @! 
448 LINE.NUM ^nFindCmd @@ -1 > IF 
449 LINE.NUM }EcbBitData 0 }ntEcbCmd 0 16  CopyTable  
450 LINE.NUM 0 13 }ntEcbCmd TABLE! 
451 LINE.NUM 1 7 }ntEcbCmd TABLE! 
452 LINE.NUM 0 ^MasterEcbCmd @! 
453 LINE.NUM 15 ^Count1 @! 
455 LINE.NUM BEGIN ^Count1 @@ -1 > WHILE 
456 LINE.NUM ^Count1 @@ }ntEcbCmd TABLE@ 1 = IF 
457 LINE.NUM ^MasterEcbCmd @@F 2 I>F ^Count1 @@F  F^ F+ ^MasterEcbCmd F@! 
458 LINE.NUM THEN 
459 LINE.NUM ^Count1 @@ 1 -  ^Count1 @! 
460 LINE.NUM REPEAT 
461 LINE.NUM 1 ^MasterEcbFlag @! 
462 LINE.NUM " Success=TRUE" *Status  $MOVE 
463 LINE.NUM THEN 
466 LINE.NUM " MCB_SERVOFANS2_ON" 0 *sCmd  FindSubString ^nFindCmd @! 
467 LINE.NUM ^nFindCmd @@ -1 > IF 
468 LINE.NUM }EcbBitData 0 }ntEcbCmd 0 16  CopyTable  
469 LINE.NUM 1 15 }ntEcbCmd TABLE! 
470 LINE.NUM 1 7 }ntEcbCmd TABLE! 
471 LINE.NUM 0 ^MasterEcbCmd @! 
472 LINE.NUM 15 ^Count1 @! 
474 LINE.NUM BEGIN ^Count1 @@ -1 > WHILE 
475 LINE.NUM ^Count1 @@ }ntEcbCmd TABLE@ 1 = IF 
476 LINE.NUM ^MasterEcbCmd @@F 2 I>F ^Count1 @@F  F^ F+ ^MasterEcbCmd F@! 
477 LINE.NUM THEN 
478 LINE.NUM ^Count1 @@ 1 -  ^Count1 @! 
479 LINE.NUM REPEAT 
480 LINE.NUM 1 ^MasterEcbFlag @! 
481 LINE.NUM " Success=TRUE" *Status  $MOVE 
482 LINE.NUM THEN 
485 LINE.NUM " MCB_SERVOFANS2_OFF" 0 *sCmd  FindSubString ^nFindCmd @! 
486 LINE.NUM ^nFindCmd @@ -1 > IF 
487 LINE.NUM }EcbBitData 0 }ntEcbCmd 0 16  CopyTable  
488 LINE.NUM 0 15 }ntEcbCmd TABLE! 
489 LINE.NUM 1 7 }ntEcbCmd TABLE! 
490 LINE.NUM 0 ^MasterEcbCmd @! 
491 LINE.NUM 15 ^Count1 @! 
493 LINE.NUM BEGIN ^Count1 @@ -1 > WHILE 
494 LINE.NUM ^Count1 @@ }ntEcbCmd TABLE@ 1 = IF 
495 LINE.NUM ^MasterEcbCmd @@F 2 I>F ^Count1 @@F  F^ F+ ^MasterEcbCmd F@! 
496 LINE.NUM THEN 
497 LINE.NUM ^Count1 @@ 1 -  ^Count1 @! 
498 LINE.NUM REPEAT 
499 LINE.NUM 1 ^MasterEcbFlag @! 
500 LINE.NUM " Success=TRUE" *Status  $MOVE 
501 LINE.NUM THEN 
504 LINE.NUM " MCB_TENTSTIRFANS_ON" 0 *sCmd  FindSubString ^nFindCmd @! 
505 LINE.NUM ^nFindCmd @@ -1 > IF 
506 LINE.NUM }EcbBitData 0 }ntEcbCmd 0 16  CopyTable  
507 LINE.NUM 1 14 }ntEcbCmd TABLE! 
508 LINE.NUM 1 7 }ntEcbCmd TABLE! 
509 LINE.NUM 0 ^MasterEcbCmd @! 
510 LINE.NUM 15 ^Count1 @! 
512 LINE.NUM BEGIN ^Count1 @@ -1 > WHILE 
513 LINE.NUM ^Count1 @@ }ntEcbCmd TABLE@ 1 = IF 
514 LINE.NUM ^MasterEcbCmd @@F 2 I>F ^Count1 @@F  F^ F+ ^MasterEcbCmd F@! 
515 LINE.NUM THEN 
516 LINE.NUM ^Count1 @@ 1 -  ^Count1 @! 
517 LINE.NUM REPEAT 
518 LINE.NUM 1 ^MasterEcbFlag @! 
519 LINE.NUM " Success=TRUE" *Status  $MOVE 
520 LINE.NUM THEN 
523 LINE.NUM " MCB_TENTSTIRFANS_OFF" 0 *sCmd  FindSubString ^nFindCmd @! 
524 LINE.NUM ^nFindCmd @@ -1 > IF 
525 LINE.NUM }EcbBitData 0 }ntEcbCmd 0 16  CopyTable  
526 LINE.NUM 0 14 }ntEcbCmd TABLE! 
527 LINE.NUM 1 7 }ntEcbCmd TABLE! 
528 LINE.NUM 0 ^MasterEcbCmd @! 
529 LINE.NUM 15 ^Count1 @! 
531 LINE.NUM BEGIN ^Count1 @@ -1 > WHILE 
532 LINE.NUM ^Count1 @@ }ntEcbCmd TABLE@ 1 = IF 
533 LINE.NUM ^MasterEcbCmd @@F 2 I>F ^Count1 @@F  F^ F+ ^MasterEcbCmd F@! 
534 LINE.NUM THEN 
535 LINE.NUM ^Count1 @@ 1 -  ^Count1 @! 
536 LINE.NUM REPEAT 
537 LINE.NUM 1 ^MasterEcbFlag @! 
538 LINE.NUM " Success=TRUE" *Status  $MOVE 
539 LINE.NUM THEN 
542 LINE.NUM " STATUS" 0 *sCmd  FindSubString ^nFindCmd @! 
543 LINE.NUM ^nFindCmd @@ -1 > IF 
544 LINE.NUM " Success=True" *Status  $MOVE 
546 LINE.NUM " , ICDversion=" *Status $CAT 

547 LINE.NUM *sICDversion *Status $CAT 

549 LINE.NUM " , FWversion=" *Status $CAT 

550 LINE.NUM *sFWversion *Status $CAT 

552 LINE.NUM " , SWversion=" *Status $CAT 

553 LINE.NUM *sSWversion *Status $CAT 

555 LINE.NUM " , SystemUpTime=" *Status $CAT 

556 LINE.NUM  GetSystemTime 86400 / I>F ^fSystemUpTime @! 
557 LINE.NUM ^fSystemUpTime @@ 8 2 *sPACuptime  FF.R$ 
558 LINE.NUM *sPACuptime *Status $CAT 

560 LINE.NUM " , HeartbeatDownTimer=" *Status $CAT 

561 LINE.NUM ^dtHeartbeat @@F 2 0 *sHeartbeat  FF.R$ 
562 LINE.NUM *sHeartbeat *Status $CAT 

564 LINE.NUM *sFaultList  $LEN IF 
565 LINE.NUM " , Fault=TRUE" *Status $CAT 

566 LINE.NUM ELSE 
567 LINE.NUM " , Fault=FALSE" *Status $CAT 

568 LINE.NUM THEN 
570 LINE.NUM *sErrorList  $LEN IF 
571 LINE.NUM " , Error=TRUE" *Status $CAT 

572 LINE.NUM ELSE 
573 LINE.NUM " , Error=FALSE" *Status $CAT 

574 LINE.NUM THEN 
579 LINE.NUM ~AI_IglooStirFanM282_Tach @@ 100 I>F F* 148 I>F F/ ^nFanSpd F@! 
580 LINE.NUM ^nFanSpd @@ *sFanSpd  I>$ 
581 LINE.NUM " , IglooStirFan1Tach=" *Status $CAT 

582 LINE.NUM *sFanSpd *Status $CAT 

584 LINE.NUM ~AI_IglooStirFanM284_Tach @@ 100 I>F F* 148 I>F F/ ^nFanSpd F@! 
585 LINE.NUM ^nFanSpd @@ *sFanSpd  I>$ 
586 LINE.NUM " , IglooStirFan2Tach=" *Status $CAT 

587 LINE.NUM *sFanSpd *Status $CAT 

589 LINE.NUM ~AI_IglooStirFanM292_Tach @@ 100 I>F F* 148 I>F F/ ^nFanSpd F@! 
590 LINE.NUM ^nFanSpd @@ *sFanSpd  I>$ 
591 LINE.NUM " , IglooStirFan3Tach=" *Status $CAT 

592 LINE.NUM *sFanSpd *Status $CAT 

594 LINE.NUM ~AI_IglooStirFanM294_Tach @@ 100 I>F F* 148 I>F F/ ^nFanSpd F@! 
595 LINE.NUM ^nFanSpd @@ *sFanSpd  I>$ 
596 LINE.NUM " , IglooStirFan4Tach=" *Status $CAT 

597 LINE.NUM *sFanSpd *Status $CAT 

599 LINE.NUM ~AI_TentIntakeFanM304_Tach @@ 100 I>F F* 148 I>F F/ ^nFanSpd F@! 
600 LINE.NUM ^nFanSpd @@ *sFanSpd  I>$ 
601 LINE.NUM " , TentIntakeFan1Tach=" *Status $CAT 

602 LINE.NUM *sFanSpd *Status $CAT 

604 LINE.NUM ~AI_TentExhaustFanM306_Tach @@ 100 I>F F* 148 I>F F/ ^nFanSpd F@! 
605 LINE.NUM ^nFanSpd @@ *sFanSpd  I>$ 
606 LINE.NUM " , TentExhaustFan1Tach=" *Status $CAT 

607 LINE.NUM *sFanSpd *Status $CAT 

609 LINE.NUM ~AI_TentIntakeFanM312_Tach @@ 100 I>F F* 148 I>F F/ ^nFanSpd F@! 
610 LINE.NUM ^nFanSpd @@ *sFanSpd  I>$ 
611 LINE.NUM " , TentIntakeFan2Tach=" *Status $CAT 

612 LINE.NUM *sFanSpd *Status $CAT 

614 LINE.NUM ~AI_TentExhaustFanM314_Tach @@ 100 I>F F* 148 I>F F/ ^nFanSpd F@! 
615 LINE.NUM ^nFanSpd @@ *sFanSpd  I>$ 
616 LINE.NUM " , TentExhaustFan2Tach=" *Status $CAT 

617 LINE.NUM *sFanSpd *Status $CAT 

619 LINE.NUM ~AI_TentStirFanM323_Tach @@ 100 I>F F* 110 I>F F/ ^nFanSpd F@! 
620 LINE.NUM ^nFanSpd @@ *sFanSpd  I>$ 
621 LINE.NUM " , TentStirFan1Tach=" *Status $CAT 

622 LINE.NUM *sFanSpd *Status $CAT 

624 LINE.NUM ~AI_TentStirFanM325_Tach @@ 100 I>F F* 110 I>F F/ ^nFanSpd F@! 
625 LINE.NUM ^nFanSpd @@ *sFanSpd  I>$ 
626 LINE.NUM " , TentStirFan2Tach=" *Status $CAT 

627 LINE.NUM *sFanSpd *Status $CAT 

629 LINE.NUM ~AI_PanelFanM184_Tach @@ 100 I>F F* 110 I>F F/ ^nFanSpd F@! 
630 LINE.NUM ^nFanSpd @@ *sFanSpd  I>$ 
631 LINE.NUM " , PanelIntakeFan1Tach=" *Status $CAT 

632 LINE.NUM *sFanSpd *Status $CAT 

634 LINE.NUM ~AI_PanelFanM186_Tach @@ 100 I>F F* 110 I>F F/ ^nFanSpd F@! 
635 LINE.NUM ^nFanSpd @@ *sFanSpd  I>$ 
636 LINE.NUM " , PanelIntakeFan2Tach=" *Status $CAT 

637 LINE.NUM *sFanSpd *Status $CAT 

639 LINE.NUM ~AI_Utility_Volt @@ 5 1 *sVoltage  FF.R$ 
640 LINE.NUM " , UtilityVoltage=" *Status $CAT 

641 LINE.NUM *sVoltage *Status $CAT 

643 LINE.NUM ~AI_CryoTig_Volt @@ 5 1 *sVoltage  FF.R$ 
644 LINE.NUM " , CryotigerVoltage=" *Status $CAT 

645 LINE.NUM *sVoltage *Status $CAT 

647 LINE.NUM " , PanelTemperature=" *Status $CAT 

648 LINE.NUM ~AI_P119_Temp @@ 5 2 *sFanSpd  FF.R$ 
649 LINE.NUM *sFanSpd *Status $CAT 

651 LINE.NUM ~AI_CryoTig_Current @@ 5 2 *sCurrent  FF.R$ 
652 LINE.NUM " , CryotigerCurrent=" *Status $CAT 

653 LINE.NUM *sCurrent *Status $CAT 

655 LINE.NUM ~AI_CryoTig_OutputPressure @@ 6 2 *sPressure  FF.R$ 
656 LINE.NUM " , CryotigerOutputPressure=" *Status $CAT 

657 LINE.NUM *sPressure *Status $CAT 

659 LINE.NUM ~AI_CryoTig_ReturnPressure @@ 6 2 *sPressure  FF.R$ 
660 LINE.NUM " , CryotigerReturnPressure=" *Status $CAT 

661 LINE.NUM *sPressure *Status $CAT 

663 LINE.NUM ~DI_LightSW @@I IF 
664 LINE.NUM " , LightsOn=True" *Status $CAT 

665 LINE.NUM ELSE 
666 LINE.NUM " , LightsOn=False" *Status $CAT 

667 LINE.NUM THEN 
669 LINE.NUM ~DI_EntryDoor @@I IF 
670 LINE.NUM " , EntryDoor=CLOSED" *Status $CAT 

671 LINE.NUM ELSE 
672 LINE.NUM " , EntryDoor=OPEN" *Status $CAT 

673 LINE.NUM THEN 
675 LINE.NUM ~DI_PanelDoor @@I IF 
676 LINE.NUM " , PanelDoor=CLOSED" *Status $CAT 

677 LINE.NUM ELSE 
678 LINE.NUM " , PanelDoor=OPEN" *Status $CAT 

679 LINE.NUM THEN 
681 LINE.NUM 1 ^nCounter2 @! 
682 LINE.NUM BEGIN 
683 LINE.NUM " , RTD" *Status $CAT 

684 LINE.NUM ^nCounter2 @@ *sCounter2  I>$ 
685 LINE.NUM *sCounter2 *Status $CAT 

686 LINE.NUM " =" *Status $CAT 

687 LINE.NUM ^nCounter2 @@ {stDTdata $TABLE@ *Status $CAT 

688 LINE.NUM ^nCounter2 @@ 1 +  ^nCounter2 @! 
689 LINE.NUM ^nCounter2 @@ 10 > UNTIL 
692 LINE.NUM |pidTentFans  $20000.. ROT PID@ 0 = IF 
693 LINE.NUM " , TentServoFans_OpMode=AUTO" *Status $CAT 

694 LINE.NUM ELSE 
694 LINE.NUM |pidTentFans  $20000.. ROT PID@ 1 = IF 
695 LINE.NUM " , TentServoFans_OpMode=MANUAL" *Status $CAT 

696 LINE.NUM THEN THEN 
698 LINE.NUM |pidTentFans  $0002.. ROT PID@ 4 1 *sPID  FF.R$ 
699 LINE.NUM " , TentServoFans_Setpoint=" *Status $CAT 

700 LINE.NUM *sPID *Status $CAT 

702 LINE.NUM |pidTentFans  $0001.. ROT PID@ 6 3 *sPID  FF.R$ 
703 LINE.NUM " , TentServoFans_Input=" *Status $CAT 

704 LINE.NUM *sPID *Status $CAT 

706 LINE.NUM |pidTentFans  $0008.. ROT PID@ 4 1 *sPID  FF.R$ 
707 LINE.NUM " , TentServoFans_Output=" *Status $CAT 

708 LINE.NUM *sPID *Status $CAT 

710 LINE.NUM |pidTentFans  $0010.. ROT PID@ 7 3 *sPID  FF.R$ 
711 LINE.NUM " , TentServoFans_Gain=" *Status $CAT 

712 LINE.NUM *sPID *Status $CAT 

714 LINE.NUM |pidTentFans  $0020.. ROT PID@ 7 3 *sPID  FF.R$ 
715 LINE.NUM " , TentServoFans_Integral=" *Status $CAT 

716 LINE.NUM *sPID *Status $CAT 

718 LINE.NUM |pidTentFans  $0040.. ROT PID@ 7 3 *sPID  FF.R$ 
719 LINE.NUM " , TentServoFans_Derivative=" *Status $CAT 

720 LINE.NUM *sPID *Status $CAT 

722 LINE.NUM |pidTentFans  $4000.. ROT PID@ 7 3 *sPID  FF.R$ 
723 LINE.NUM " , TentServoFans_Scantime=" *Status $CAT 

724 LINE.NUM *sPID *Status $CAT 

725 LINE.NUM THEN 
728 LINE.NUM " GET_ERRORS" 0 *sCmd  FindSubString ^nFindCmd @! 
729 LINE.NUM ^nFindCmd @@ -1 > IF 
730 LINE.NUM *sErrorList  $LEN IF 
731 LINE.NUM " Success=TRUE" *Status  $MOVE 
732 LINE.NUM *sErrorList *Status $CAT 

733 LINE.NUM ELSE 
734 LINE.NUM " Success=FALSE" *Status  $MOVE 
735 LINE.NUM THEN 
736 LINE.NUM THEN 
739 LINE.NUM " GET_FAULTS" 0 *sCmd  FindSubString ^nFindCmd @! 
740 LINE.NUM ^nFindCmd @@ -1 > IF 
741 LINE.NUM *sFaultList  $LEN IF 
742 LINE.NUM " Success=TRUE" *Status  $MOVE 
743 LINE.NUM *sFaultList *Status $CAT 

744 LINE.NUM ELSE 
745 LINE.NUM " Success=FALSE" *Status  $MOVE 
746 LINE.NUM THEN 
747 LINE.NUM THEN 
750 LINE.NUM " CLEAR_ERRORS" 0 *sCmd  FindSubString ^nFindCmd @! 
751 LINE.NUM ^nFindCmd @@ -1 > IF 
752 LINE.NUM " " *sErrorList  $MOVE 
753 LINE.NUM 500  DELAY 
754 LINE.NUM *sErrorList  $LEN IF 
755 LINE.NUM " Success=FALSE, " *Status  $MOVE 
756 LINE.NUM *sErrorList *Status $CAT 

757 LINE.NUM ELSE 
758 LINE.NUM " Success=TRUE" *Status  $MOVE 
759 LINE.NUM THEN 
760 LINE.NUM THEN 
763 LINE.NUM " CLEAR_FAULTS" 0 *sCmd  FindSubString ^nFindCmd @! 
764 LINE.NUM ^nFindCmd @@ -1 > IF 
765 LINE.NUM " " *sFaultList  $MOVE 
766 LINE.NUM 500  DELAY 
767 LINE.NUM *sFaultList  $LEN IF 
768 LINE.NUM " Success=FALSE, " *Status  $MOVE 
769 LINE.NUM *sFaultList *Status $CAT 

770 LINE.NUM ELSE 
771 LINE.NUM " Success=TRUE" *Status  $MOVE 
772 LINE.NUM THEN 
773 LINE.NUM THEN 
776 LINE.NUM " HEARTBEAT" 0 *sCmd  FindSubString ^nFindCmd @! 
777 LINE.NUM ^nFindCmd @@ -1 > IF 
778 LINE.NUM ^dtHeartbeat @@F 2 0 *sHeartbeat  FF.R$ 
779 LINE.NUM 60 I>F ^dtHeartbeat @! 
780 LINE.NUM ^dtHeartbeat  StartTimer 
781 LINE.NUM " Success=TRUE" *Status  $MOVE 
782 LINE.NUM " , HeartbeatDownTimer=" *Status $CAT 

783 LINE.NUM *sHeartbeat *Status $CAT 

789 LINE.NUM ^dt24h @@F 1 I>F F< IF 
790 LINE.NUM *sCmd  $LEN ^nStringLength @! 
791 LINE.NUM ^nStringLength @@ 28 > IF 
792 LINE.NUM " ," 0 *sCmd  FindSubString ^nStringPosition @! 
793 LINE.NUM ^nStringPosition  1+@! 
794 LINE.NUM " ," ^nStringPosition @@ *sCmd  FindSubString ^nStringPosition @! 
795 LINE.NUM ^nStringPosition  1+@! 
796 LINE.NUM *sCmd ^nStringPosition @@ 4 *sYear  $SUB 
797 LINE.NUM *sYear  $>I  I!YRS 
798 LINE.NUM ^nStringPosition @@ 4 +  ^nStringPosition @! 
799 LINE.NUM *sCmd ^nStringPosition @@ 2 *sMonth1  $SUB 
800 LINE.NUM *sMonth  $>I  I!MTH 
801 LINE.NUM ^nStringPosition @@ 2 +  ^nStringPosition @! 
802 LINE.NUM *sCmd ^nStringPosition @@ 2 *sDay1  $SUB 
803 LINE.NUM *sDay  $>I  I!DAY 
804 LINE.NUM ^nStringPosition @@ 3 +  ^nStringPosition @! 
805 LINE.NUM *sCmd ^nStringPosition @@ 2 *sTime  $SUB 
806 LINE.NUM *sTime  $>I  I!HRS 
807 LINE.NUM ^nStringPosition @@ 2 +  ^nStringPosition @! 
808 LINE.NUM *sCmd ^nStringPosition @@ 2 *sTime  $SUB 
809 LINE.NUM *sTime  $>I  I!MTS 
810 LINE.NUM ^nStringPosition @@ 2 +  ^nStringPosition @! 
811 LINE.NUM *sCmd ^nStringPosition @@ 2 *sTime  $SUB 
812 LINE.NUM *sTime  $>I  I!SEC 
813 LINE.NUM 86400 I>F ^dt24h @! 
814 LINE.NUM ^dt24h  StartTimer 
815 LINE.NUM THEN 
816 LINE.NUM THEN 
818 LINE.NUM THEN 
821 LINE.NUM " RESET" 0 *sCmd  FindSubString ^nFindCmd @! 
822 LINE.NUM ^nFindCmd @@ -1 > IF 
823 LINE.NUM &DatatakerComm  STOP.T 
824 LINE.NUM &Housekeeper  STOP.T 
825 LINE.NUM &Powerup  START.T DROP  
826 LINE.NUM &MasterComm  STOP.T 
827 LINE.NUM THEN 
830 LINE.NUM *Status  $LEN IF 
831 LINE.NUM "  " *Status $CAT 

832 LINE.NUM ELSE 
834 LINE.NUM " Success=FALSE, Unknown command " *Status  $MOVE 
835 LINE.NUM *sTimestamp4 &Timestamp CALL.SUB DROP  
836 LINE.NUM *sTimestamp4 *Status $CAT 

837 LINE.NUM THEN 
840 LINE.NUM *sTimestamp4 &Timestamp CALL.SUB DROP  
841 LINE.NUM *sTimestamp4 *Status $CAT 

842 LINE.NUM *Status *cPort  PRT$ DROP  
843 LINE.NUM " " *Status  $MOVE 
0 JUMP ;
: 4_70
-9 JUMP ;
: 4_4
FALSE

1 LINE.NUM
  ^nPortStatus @@ 
  0    =
LOR

2 LINE.NUM
  ^nPortStatus @@ 
  -47    =
LOR
IF -13 ELSE -14 THEN JUMP ;
: 4_11
FALSE

1 LINE.NUM
  ^nPortStatus @@ 
  0    =
LOR

2 LINE.NUM
  ^nPortStatus @@ 
  -47    =
LOR
IF -12 ELSE 8 THEN JUMP ;
: 4_22
TRUE

1 LINE.NUM
  ^nCharCount @@ 
  0    >
LAND
IF -9 ELSE 0 THEN JUMP ;
: 4_23
TRUE

1 LINE.NUM
  *cPort   ?OPEN 0>
LAND
IF 0 ELSE -11 THEN JUMP ;
: 4_24
TRUE

1 LINE.NUM
  ^dtSocket   T0=
LAND
IF -12 ELSE 0 THEN JUMP ;
: 4_25
TRUE

1 LINE.NUM
  ^nCharCount @@ 
  0    <
LAND
IF 0 ELSE -14 THEN JUMP ;
: 4_26
FALSE

1 LINE.NUM
  ^nCharCount @@ 
  -37    =
LOR

2 LINE.NUM
  ^nCharCount @@ 
  -39    =
LOR
IF -15 ELSE -14 THEN JUMP ;
: 4_45
TRUE

1 LINE.NUM
  ^nCharCount @@ 
  4    <
LAND
IF -15 ELSE -13 THEN JUMP ;
: 4_51
TRUE

1 LINE.NUM
  ^nReceiveStatus @@ 
  0    =
LAND
IF -13 ELSE 0 THEN JUMP ;
: 4_57
TRUE

1 LINE.NUM
  ^nReceiveStatus @@ 
  -39    =
LAND
IF -13 ELSE -17 THEN JUMP ;
: 4_121
TRUE

1 LINE.NUM
  ^nPortStatus @@ 
  -442    =
LAND
IF -22 ELSE -18 THEN JUMP ;
T: T4
DUMMY
4_0
4_2
4_6
4_9
4_13
4_17
4_19
4_28
4_37
4_43
4_49
4_55
4_59
4_64
4_70
4_4
4_11
4_22
4_23
4_24
4_25
4_26
4_45
4_51
4_57
4_121
T;
&MasterComm ' T4 SETTASK
: 5_0
0 JUMP ;
: 5_9
65 LINE.NUM 2 0 }nt03AsIntParameters TABLE! 
66 LINE.NUM 1 1 }nt03AsIntParameters TABLE! 
67 LINE.NUM 1000 2 }nt03AsIntParameters TABLE! 
68 LINE.NUM 0 3 }nt03AsIntParameters TABLE! 
69 LINE.NUM 0 4 }nt03AsIntParameters TABLE! 
0 JUMP ;
: 5_10
1 LINE.NUM ^nModbusMasterReadDelay @@  DELAY 
3 LINE.NUM *sTimestamp1 &Timestamp CALL.SUB DROP  
4 LINE.NUM *sTimestamp1 0 {stDTdata $TABLE@  $MOVE 
9 LINE.NUM *chModbusMaster }nt03AsIntParameters 0 1 }nt03HoldingRegAsIntReturnValues 16 ^n03AsIntStatus &O22Modbus03ReadHoldingRegistersAsInt CALL.SUB ^n03AsIntSubStatus @! 
13 LINE.NUM ^n03AsIntStatus @@ 0 = IF 
16 LINE.NUM 0 ^Count2 @! 
17 LINE.NUM BEGIN ^Count2 @@ 8 < WHILE 
18 LINE.NUM ^Count2 @@ 2 *  }nt03HoldingRegAsIntReturnValues TABLE@ 65536 *  ^Count2 @@ 2 *  1 +  }nt03HoldingRegAsIntReturnValues TABLE@ +  ^Count2 @@ }ntRTDdata TABLE! 
19 LINE.NUM ^Count2 @@ 1 +  ^Count2 @! 
20 LINE.NUM REPEAT 
24 LINE.NUM 0 ^Count2 @! 
25 LINE.NUM BEGIN ^Count2 @@ 8 < WHILE 
26 LINE.NUM ^Count2 @@ }ntRTDdata TABLE@F ^Count2 @@ }ntRTDtempData TABLE! 
27 LINE.NUM ^Count2 @@ 1 +  ^Count2 @! 
28 LINE.NUM REPEAT 
33 LINE.NUM 0 ^Count2 @! 
34 LINE.NUM BEGIN ^Count2 @@ 8 < WHILE 
35 LINE.NUM ^Count2 @@ }ntRTDtempData TABLE@ 100000 I>F F/ 1 I>F F- 3.84999998e-003 F/ ^Count2 @@ }ntRTDtempData TABLE! 
36 LINE.NUM ^Count2 @@ 1 +  ^Count2 @! 
37 LINE.NUM REPEAT 
41 LINE.NUM 1 ^Count2 @! 
42 LINE.NUM BEGIN ^Count2 @@ 9 < WHILE 
43 LINE.NUM ^Count2 @@ 1 -  }ntRTDtempData TABLE@ 11 3 ^Count2 @@ {stDTdata $TABLE@  FF.R$ 
44 LINE.NUM ^Count2 @@ 1 +  ^Count2 @! 
45 LINE.NUM REPEAT 
49 LINE.NUM 1 ^Count2 @! 
50 LINE.NUM BEGIN ^Count2 @@ 9 < WHILE 
51 LINE.NUM ^Count2 @@ {stDTdata $TABLE@ 3  SWAP $TRIM 
52 LINE.NUM ^Count2 @@ 1 +  ^Count2 @! 
53 LINE.NUM REPEAT 
58 LINE.NUM 1 ^Count2 @! 
59 LINE.NUM BEGIN ^Count2 @@ 9 < WHILE 
60 LINE.NUM ^Count2 @@ {stDTdata $TABLE@  $LEN 7 > IF 
61 LINE.NUM " NaN" ^Count2 @@ {stDTdata $TABLE@  $MOVE 
62 LINE.NUM THEN 
63 LINE.NUM ^Count2 @@ 1 +  ^Count2 @! 
64 LINE.NUM REPEAT 
68 LINE.NUM 0 ^Count2 @! 
69 LINE.NUM BEGIN ^Count2 @@ 30 < WHILE 
70 LINE.NUM ^Count2 @@ {stDTdata $TABLE@ ^Count2 @@ {stModbusData $TABLE@  $MOVE 
71 LINE.NUM ^Count2 @@ 1 +  ^Count2 @! 
72 LINE.NUM REPEAT 
75 LINE.NUM 1 ^DTlogFlag @! 
77 LINE.NUM ELSE 
79 LINE.NUM 1 ^Count2 @! 
80 LINE.NUM BEGIN ^Count2 @@ 9 < WHILE 
81 LINE.NUM " NaN" ^Count2 @@ {stDTdata $TABLE@  $MOVE 
82 LINE.NUM ^Count2 @@ 1 +  ^Count2 @! 
83 LINE.NUM REPEAT 
85 LINE.NUM THEN 
-1 JUMP ;
T: T5
DUMMY
5_0
5_9
5_10
T;
&Modbus_Master ' T5 SETTASK
: 0_0
0 JUMP ;
: 0_1
1 LINE.NUM 1 I>F  FDELAY 
4 LINE.NUM *sTimestamp &Timestamp CALL.SUB DROP  
5 LINE.NUM *sTimestamp 0 4 *sDate  $SUB 
6 LINE.NUM " -" *sDate $CAT 

7 LINE.NUM *sTimestamp 5 2 *sMonth  $SUB 
8 LINE.NUM *sMonth *sDate $CAT 

9 LINE.NUM " -" *sDate $CAT 

10 LINE.NUM *sTimestamp 8 2 *sDay  $SUB 
11 LINE.NUM *sDay *sDate $CAT 

29 LINE.NUM *sDate *sCurrentDate  $MOVE 
30 LINE.NUM *sIP_PAC  MY.ADDRESS>String 
32 LINE.NUM 500 ^nModbusMasterReadDelay @! 
34 LINE.NUM *_HSV_SEMA Acquire1String " " *_HSV_TEMP $MOVE 13  *_HSV_TEMP $APPEND 10  *_HSV_TEMP $APPEND *_HSV_TEMP *CRLF $MOVE Release1String 
35 LINE.NUM " " *LF $MOVE 10 *LF  $APPEND 
40 LINE.NUM 32 ^EcbCmd @! 
41 LINE.NUM 0 ~DO_NRES_CR @! 
67 LINE.NUM " Timestamp" 0 {stHeader $TABLE@  $MOVE 
68 LINE.NUM " TentAirUpper" 1 {stHeader $TABLE@  $MOVE 
69 LINE.NUM " CalResistor" 2 {stHeader $TABLE@  $MOVE 
70 LINE.NUM " TentIntake" 3 {stHeader $TABLE@  $MOVE 
71 LINE.NUM " OutsideAir" 4 {stHeader $TABLE@  $MOVE 
72 LINE.NUM " ACoutput" 5 {stHeader $TABLE@  $MOVE 
73 LINE.NUM " CtrlValveTemp" 6 {stHeader $TABLE@  $MOVE 
74 LINE.NUM " TentAirLower" 7 {stHeader $TABLE@  $MOVE 
75 LINE.NUM " ChamberPressSenTemp" 8 {stHeader $TABLE@  $MOVE 
76 LINE.NUM " PID_Setpoint" 9 {stHeader $TABLE@  $MOVE 
77 LINE.NUM " PID_Input" 10 {stHeader $TABLE@  $MOVE 
78 LINE.NUM " PID_Output" 11 {stHeader $TABLE@  $MOVE 
79 LINE.NUM " IntakeFanSpd1" 12 {stHeader $TABLE@  $MOVE 
80 LINE.NUM " IntakeFanSpd2" 13 {stHeader $TABLE@  $MOVE 
81 LINE.NUM " PID_Gain" 14 {stHeader $TABLE@  $MOVE 
82 LINE.NUM " PID_Integral" 15 {stHeader $TABLE@  $MOVE 
83 LINE.NUM " PID_Derivative" 16 {stHeader $TABLE@  $MOVE 
84 LINE.NUM " PID_Scanrate" 17 {stHeader $TABLE@  $MOVE 
86 LINE.NUM " 0.1" 
*sICDversion  $MOVE 
87 LINE.NUM *sFWversion  Rev>$ 
88 LINE.NUM " 0.1" *sSWversion  $MOVE 
90 LINE.NUM 300 I>F ^dtFanMonitor @! 
91 LINE.NUM ^dtFanMonitor  StartTimer 
94 LINE.NUM ~DI_NRES_Deadman @@I 1 = IF 
95 LINE.NUM 1 ~DO_CryoTig_CR @! 
96 LINE.NUM ELSE 
97 LINE.NUM 0 ~DO_CryoTig_CR @! 
98 LINE.NUM 300 I>F ^CryoTigThermalTimer @! 
99 LINE.NUM ^CryoTigThermalTimer  StartTimer 
100 LINE.NUM THEN 
107 LINE.NUM 5 I>F ~AO_PanelFans_CTRL @! 
110 LINE.NUM 10 I>F  FDELAY 
113 LINE.NUM ~AI_PanelFanM184_Tach @@ 99 I>F F>= ~AI_PanelFanM186_Tach @@ 99 I>F F>= LAND  IF 
114 LINE.NUM 5 I>F ^PanelFanMaxCtrl @! 
115 LINE.NUM ELSE 
115 LINE.NUM ~AI_PanelFanM184_Tach @@ 99 I>F F>= ~AI_PanelFanM186_Tach @@ 99 I>F F< LAND  IF 
116 LINE.NUM 5 I>F ^PanelFanMaxCtrl @! 
117 LINE.NUM 1 ^PanelFanM186_ErrorFlag @! 
118 LINE.NUM ELSE 
118 LINE.NUM ~AI_PanelFanM184_Tach @@ 99 I>F F< ~AI_PanelFanM186_Tach @@ 99 I>F F>= LAND  IF 
119 LINE.NUM 5 I>F ^PanelFanMaxCtrl @! 
120 LINE.NUM 1 ^PanelFanM184_ErrorFlag @! 
121 LINE.NUM ELSE 
121 LINE.NUM ~AI_PanelFanM184_Tach @@ 99 I>F F< ~AI_PanelFanM186_Tach @@ 99 I>F F< LAND  IF 
122 LINE.NUM 10 I>F ~AO_PanelFans_CTRL @! 
123 LINE.NUM 10 I>F  FDELAY 
124 LINE.NUM ~AI_PanelFanM184_Tach @@ 99 I>F F>= ~AI_PanelFanM186_Tach @@ 99 I>F F>= LAND  IF 
125 LINE.NUM 10 I>F ^PanelFanMaxCtrl @! 
126 LINE.NUM ELSE 
126 LINE.NUM ~AI_PanelFanM184_Tach @@ 99 I>F F>= ~AI_PanelFanM186_Tach @@ 99 I>F F< LAND  IF 
127 LINE.NUM 10 I>F ^PanelFanMaxCtrl @! 
128 LINE.NUM 1 ^PanelFanM186_ErrorFlag @! 
129 LINE.NUM ELSE 
129 LINE.NUM ~AI_PanelFanM184_Tach @@ 99 I>F F< ~AI_PanelFanM186_Tach @@ 99 I>F F>= LAND  IF 
130 LINE.NUM 10 I>F ^PanelFanMaxCtrl @! 
131 LINE.NUM 1 ^PanelFanM184_ErrorFlag @! 
132 LINE.NUM ELSE 
132 LINE.NUM ~AI_PanelFanM184_Tach @@ 99 I>F F< ~AI_PanelFanM186_Tach @@ 99 I>F F< LAND  IF 
133 LINE.NUM 1 ^PanelFanM186_ErrorFlag @! 
134 LINE.NUM 1 ^PanelFanM184_ErrorFlag @! 
135 LINE.NUM 5 I>F ^PanelFanMaxCtrl @! 
136 LINE.NUM THEN THEN THEN THEN 
137 LINE.NUM THEN THEN THEN THEN 
171 LINE.NUM " file:w,/sdcard0/readme.txt" *ch_SDcard  $MOVE 
172 LINE.NUM *ch_SDcard  OPEN DROP  
173 LINE.NUM *ch_SDcard  ?OPEN 0> IF 
174 LINE.NUM " " *sSDcard  $MOVE 
175 LINE.NUM *_HSV_SEMA Acquire1String " This disk contains calibration values for the NRES igloo temperature controller."  *_HSV_TEMP $MOVE *CRLF  *_HSV_TEMP $CAT *_HSV_TEMP *sSDcard $MOVE Release1String 
176 LINE.NUM " Each value is located in a separate text file, with the value followed by a ',' as a delimiter." *sSDcard $CAT 

177 LINE.NUM *CRLF *sSDcard $CAT 

178 LINE.NUM *sSDcard *ch_SDcard  PRT$ DROP  
179 LINE.NUM *ch_SDcard  CLOSE DROP  
180 LINE.NUM ELSE 
182 LINE.NUM THEN 
189 LINE.NUM " file:r,/sdcard0/setpoint.txt" *ch_SDcard  $MOVE 
190 LINE.NUM *ch_SDcard  OPEN DROP  
191 LINE.NUM *ch_SDcard  ?OPEN 0> IF 
192 LINE.NUM *ch_SDcard 44  S.!EOL 
193 LINE.NUM *sPidSetpoint *ch_SDcard  GET$ DROP  
194 LINE.NUM *sPidSetpoint  $>F ^PidSetpoint @! 
195 LINE.NUM |pidTentFans ^PidSetpoint @@  $0002.. 3 ROLL !PID 
196 LINE.NUM *ch_SDcard  CLOSE DROP  
197 LINE.NUM ELSE 
199 LINE.NUM THEN 
206 LINE.NUM " file:r,/sdcard0/stirfans.txt" *ch_SDcard  $MOVE 
207 LINE.NUM *ch_SDcard  OPEN DROP  
208 LINE.NUM *ch_SDcard  ?OPEN 0> IF 
209 LINE.NUM *ch_SDcard 44  S.!EOL 
210 LINE.NUM *sStirFansSpd *ch_SDcard  GET$ DROP  
211 LINE.NUM *sStirFansSpd  $>F ~AO_StirFans_CTRL @! 
212 LINE.NUM *ch_SDcard  CLOSE DROP  
213 LINE.NUM ELSE 
215 LINE.NUM THEN 
0 JUMP ;
: 0_3
3 LINE.NUM " 99.905" *sRTD1_R0  $MOVE 
4 LINE.NUM " 99.956" *sRTD2_R0  $MOVE 
5 LINE.NUM " 99.951" *sRTD3_R0  $MOVE 
6 LINE.NUM " 99.9" *sRTD4_R0  $MOVE 
7 LINE.NUM " 99.984" *sRTD5_R0  $MOVE 
8 LINE.NUM " 99.8" *sRTD6_R0  $MOVE 
9 LINE.NUM " 99.802" *sRTD7_R0  $MOVE 
10 LINE.NUM " 99.853" *sRTD8_R0  $MOVE 
0 JUMP ;
: 0_5
11 LINE.NUM *sIP_PAC  IP$>I ^nIP_int @! 
12 LINE.NUM ^nIP_int @@ *sIP_hex  I>HEX$ 
13 LINE.NUM *sIP_hex  $LEN ^nLength @! 
14 LINE.NUM ^nLength @@ 8 < IF 
15 LINE.NUM *_HSV_SEMA Acquire1String " 0"  *_HSV_TEMP $MOVE *sIP_hex  *_HSV_TEMP $CAT *_HSV_TEMP *sIP_hex $MOVE Release1String 
16 LINE.NUM THEN 
17 LINE.NUM *sIP_hex 0 2 *sOctet1  $SUB 
18 LINE.NUM *sIP_hex 2 2 *sOctet2  $SUB 
19 LINE.NUM *sIP_hex 4 2 *sOctet3  $SUB 
31 LINE.NUM *_HSV_SEMA Acquire1String *sOctet1  *_HSV_TEMP $MOVE *sOctet2  *_HSV_TEMP $CAT *sOctet3  *_HSV_TEMP $CAT 48  *_HSV_TEMP $APPEND 51  *_HSV_TEMP $APPEND *_HSV_TEMP *sIP_hex $MOVE Release1String 
33 LINE.NUM *sIP_hex  HEX$>I ^nIP_int @! 
34 LINE.NUM ^nIP_int @@ *sDT_IP  I>IP$ 
35 LINE.NUM *_HSV_SEMA Acquire1String " tcp:"  *_HSV_TEMP $MOVE *sDT_IP  *_HSV_TEMP $CAT " :502"  *_HSV_TEMP $CAT *_HSV_TEMP *sDT_IP $MOVE Release1String 
37 LINE.NUM *sDT_IP *chModbusMaster  $MOVE 
0 JUMP ;
: 0_7
3 LINE.NUM &Housekeeper  START.T DROP  
4 LINE.NUM &MasterComm  START.T DROP  
5 LINE.NUM &Modbus_Master  START.T DROP  
0 JUMP ;
T: T0
DUMMY
0_0
0_1
0_3
0_5
0_7
T;
&Powerup ' T0 SETTASK
CREATE T.ARRAY
&DatatakerComm ,
&GoogleComm ,
&Housekeeper ,
&MasterComm ,
&Modbus_Master ,
&Powerup ,
 0 ,
CREATE V.ARRAY
^AirCon_CR_ErrorFlag ,
^AirConOffFlag ,
^Bitmask ,
^CalcFanSpd ,
^Count ,
^Count1 ,
^Count2 ,
^Count3 ,
^Cryotig_CR_ErrorFlag ,
^CryoTigOffFlag ,
^DeadmanFlag ,
^done ,
^DTcharCount ,
^DTcommStatus ,
^DTdataErrorPosition ,
^DTerrorFlag ,
^DTlogFlag ,
^EcbBit ,
^EcbCmd ,
^EcbMsg ,
^EcbResetFlag ,
^EOM_term ,
^Fan10V_TestFlag ,
^FanCtrl ,
^FanSpd ,
^fCheck ,
^fFanCtrl ,
^fFanSpd ,
^fPidInput ,
^fRTD1_R0 ,
^fRTD2_R0 ,
^fRTD3_R0 ,
^fRTD4_R0 ,
^fRTD5_R0 ,
^fRTD6_R0 ,
^fRTD7_R0 ,
^fRTD8_R0 ,
^fSystemUpTime ,
^GoogleCommStatus ,
^IglooOverTemp ,
^IglooStirFanM282_ErrorFlag ,
^IglooStirFanM284_ErrorFlag ,
^IglooStirFanM292_ErrorFlag ,
^IglooStirFanM294_ErrorFlag ,
^IglooTemp ,
^IglooTempOK ,
^intTest ,
^Length1 ,
^MasterEcbCmd ,
^MasterEcbFlag ,
^n03AsIntStatus ,
^n03AsIntSubStatus ,
^nCharCount ,
^nCounter1 ,
^nCounter2 ,
^nDTcharacterCount ,
^nDTreceiveStatus ,
^nFanSpd ,
^nFindCmd ,
^nGooglePostDataLength ,
^nIndex ,
^nIP_int ,
^nLength ,
^nModbusMasterReadDelay ,
^nOctet3 ,
^nPortStatus ,
^nReceiveStatus ,
^NRES_CR_ErrorFlag ,
^nStirFansSpd ,
^nStringLength ,
^nStringPosition ,
^Old_AO_PanelFans_CTRL ,
^Old_AO_StirFansCTRL ,
^Old_AO_TentServoFan_Ctrl ,
^Old_AO_TentStirFan_Ctrl ,
^OldDTcommHandle ,
^OldPosition ,
^P119Temp ,
^P119TempOK ,
^PanelFanM184_ErrorFlag ,
^PanelFanM186_ErrorFlag ,
^PanelFanMaxCtrl ,
^PanelTemp ,
^PidSetpoint ,
^Position ,
^Preset ,
^RedLink_CR_ErrorFlag ,
^SendData ,
^SubStringLength ,
^TentExhaustFanM306_ErrorFlag ,
^TentExhaustFanM314_ErrorFlag ,
^TentIntakeFanM304_ErrorFlag ,
^TentIntakeFanM312_ErrorFlag ,
^TentStirFanM323_ErrorFlag ,
^TentStirFanM325_ErrorFlag ,
^TentStirFanMaxCtrl ,
^TentTemp ,
^TentTempOK ,
^Thermostat_CR_ErrorFlag ,
^Utility_Volt_WatchdogFlag ,
^WriteToLogFailedFlag ,
^x ,
^y ,
*CRLF ,
*DTdata ,
*DTmessageReceived ,
*LF ,
*sCmd ,
*sCounter2 ,
*sCryoTigThermalTimer ,
*sCurrent ,
*sCurrentDate ,
*sCurrentLogCommHandle ,
*sCurrentLogFile ,
*sCurrentTime ,
*sDate ,
*sDatestamp ,
*sDay ,
*sDay1 ,
*sDT_IP ,
*sDTerror ,
*sDTrequest ,
*sErrorList ,
*sFanSpd ,
*sFaultList ,
*sFTPcmd ,
*sFWversion ,
*sGooglePostData ,
*sGooglePostDataLength ,
*sGooglePostHeader ,
*sHeartbeat ,
*sICDversion ,
*sIP_hex ,
*sIP_PAC ,
*sLog ,
*sMonth ,
*sMonth1 ,
*sNewLog ,
*sNewLogCommHandle ,
*sNewLogFile ,
*sOctet1 ,
*sOctet2 ,
*sOctet3 ,
*sOldDTerror ,
*sPACuptime ,
*sPID ,
*sPidSetpoint ,
*sPressure ,
*sRTD1_R0 ,
*sRTD2_R0 ,
*sRTD3_R0 ,
*sRTD4_R0 ,
*sRTD5_R0 ,
*sRTD6_R0 ,
*sRTD7_R0 ,
*sRTD8_R0 ,
*sSDcard ,
*sStirFansSpd ,
*sSWversion ,
*Status ,
*sTentFansSpd ,
*sTime ,
*sTimestamp ,
*sTimestamp1 ,
*sTimestamp2 ,
*sTimestamp3 ,
*sTimestamp4 ,
*sVar ,
*sVar1 ,
*sVoltage ,
*sYear ,
*_HSV_SEMA ,
*_HSV_TEMP ,
*ch_SDcard ,
*chModbusMaster ,
*cPort ,
*DTcommHandle ,
*FTPcommHandle ,
*GoogleCommHandle ,
*LogCommHandle ,
 0 ,
CREATE TI.ARRAY
^CryoTigThermalTimer ,
^dt24h ,
^dtAirCon_CR ,
^dtAwaitingDT ,
^dtFanMonitor ,
^dtGooglePost ,
^dtHeartbeat ,
^dtRequestTimer ,
^dtSocket ,
^Timer ,
 0 ,
CREATE PTR.ARRAY
 0 ,
CREATE TA.ARRAY 
}EcbBitData ,
}EcbStatus ,
}nt03AsIntParameters ,
}nt03HoldingRegAsIntReturnValues ,
}ntEcbCmd ,
}ntRTDdata ,
}ntRTDtempData ,
{stDTdata ,
{stHeader ,
{stModbusData ,
 0 ,
CREATE PTRTABLE.ARRAY 
 0 ,
CREATE B.ARRAY
%local_io ,
 0 ,
CREATE P.ARRAY
~DI_AirCon_CR_NC ,
~DI_AirConPWR_OK ,
~DI_CryoTig_CR_NC ,
~DI_ECB_OK ,
~DI_ECB_Rx ,
~DI_EntryDoor ,
~DI_HeatAlarm ,
~DI_LightSW ,
~DI_NRES_CR_NO ,
~DI_NRES_Deadman ,
~DI_NRES_PWR_OK ,
~DI_PanelDoor ,
~DI_SmokeAlarm ,
~DI_SmokePWR_OK ,
~DI_Spare_CR_NC ,
~DI_TVS ,
~DO_AirCon_CR ,
~DO_CryoTig_CR ,
~DO_ECB_Tx ,
~DO_NRES_CR ,
~AI_CA_SupplyPressure ,
~AI_CryoTig_Current ,
~AI_CryoTig_OutputPressure ,
~AI_CryoTig_ReturnPressure ,
~AI_CryoTig_Volt ,
~AI_HVAC_Current ,
~AI_Igloo_Temp ,
~AI_IglooStirFanM282_Tach ,
~AI_IglooStirFanM284_Tach ,
~AI_IglooStirFanM292_Tach ,
~AI_IglooStirFanM294_Tach ,
~AI_P119_Temp ,
~AI_PanelFanM184_Tach ,
~AI_PanelFanM186_Tach ,
~AI_TentExhaustFanM306_Tach ,
~AI_TentExhaustFanM314_Tach ,
~AI_TentIntakeFanM304_Tach ,
~AI_TentIntakeFanM312_Tach ,
~AI_TentStirFanM323_Tach ,
~AI_TentStirFanM325_Tach ,
~AI_Utility_Volt ,
~AO_PanelFans_CTRL ,
~AO_StirFans_CTRL ,
~AO_TentServoFan_Ctrl ,
~AO_TentStirFan_Ctrl ,
 0 ,
CREATE PID.ARRAY
 |pidTentFans ,
 0 ,
CREATE E/R.ARRAY
 0 ,
CREATE E/RGROUP.ARRAY
 0 ,
: CONFIG_PORTS
;
: W_INIT_IO
CONFIG_PORTS
|pidTentFans ENABLE
" %local_io  (1/1)" *_HSV_INIT_IO $MOVE 0 ^_HNV_INIT_IO @!
%local_io ENABLE
 -1 ~DO_AirCon_CR @!
 " Initializing variables" *_HSV_INIT_IO $MOVE
0 ^AirCon_CR_ErrorFlag @!
0 ^AirConOffFlag @!
0 ^Bitmask @!
0.00000000 ^CalcFanSpd @!
0 ^Count @!
0 ^Count1 @!
0 ^Count2 @!
0 ^Count3 @!
0 ^Cryotig_CR_ErrorFlag @!
0 ^CryoTigOffFlag @!
0.0 ^CryoTigThermalTimer @!
0 ^DeadmanFlag @!
0 ^done @!
0.0 ^dt24h @!
0.0 ^dtAirCon_CR @!
0.0 ^dtAwaitingDT @!
0 ^DTcharCount @!
0 ^DTcommStatus @!
0 ^DTdataErrorPosition @!
0 ^DTerrorFlag @!
0.0 ^dtFanMonitor @!
0.0 ^dtGooglePost @!
0.0 ^dtHeartbeat @!
0 ^DTlogFlag @!
0.0 ^dtRequestTimer @!
0.0 ^dtSocket @!
0 ^EcbBit @!
0 ^EcbCmd @!
0 ^EcbMsg @!
0 ^EcbResetFlag @!
0 ^EOM_term @!
0 ^Fan10V_TestFlag @!
0 ^FanCtrl @!
0.00000000 ^FanSpd @!
0.00000000 ^fCheck @!
0.00000000 ^fFanCtrl @!
0.00000000 ^fFanSpd @!
0.00000000 ^fPidInput @!
0.00000000 ^fRTD1_R0 @!
0.00000000 ^fRTD2_R0 @!
0.00000000 ^fRTD3_R0 @!
0.00000000 ^fRTD4_R0 @!
0.00000000 ^fRTD5_R0 @!
0.00000000 ^fRTD6_R0 @!
0.00000000 ^fRTD7_R0 @!
0.00000000 ^fRTD8_R0 @!
0.00000000 ^fSystemUpTime @!
0 ^GoogleCommStatus @!
0 ^IglooOverTemp @!
0 ^IglooStirFanM282_ErrorFlag @!
0 ^IglooStirFanM284_ErrorFlag @!
0 ^IglooStirFanM292_ErrorFlag @!
0 ^IglooStirFanM294_ErrorFlag @!
0.00000000 ^IglooTemp @!
0 ^IglooTempOK @!
0 ^intTest @!
0 ^Length1 @!
0 ^MasterEcbCmd @!
0 ^MasterEcbFlag @!
0 ^n03AsIntStatus @!
0 ^n03AsIntSubStatus @!
0 ^nCharCount @!
0 ^nCounter1 @!
0 ^nCounter2 @!
0 ^nDTcharacterCount @!
0 ^nDTreceiveStatus @!
0 ^nFanSpd @!
0 ^nFindCmd @!
0 ^nGooglePostDataLength @!
0 ^nIndex @!
0 ^nIP_int @!
0 ^nLength @!
0 ^nModbusMasterReadDelay @!
0 ^nOctet3 @!
0 ^nPortStatus @!
0 ^nReceiveStatus @!
0 ^NRES_CR_ErrorFlag @!
0 ^nStirFansSpd @!
0 ^nStringLength @!
0 ^nStringPosition @!
0.00000000 ^Old_AO_PanelFans_CTRL @!
0.00000000 ^Old_AO_StirFansCTRL @!
0.00000000 ^Old_AO_TentServoFan_Ctrl @!
0.00000000 ^Old_AO_TentStirFan_Ctrl @!
0 ^OldDTcommHandle @!
0 ^OldPosition @!
0.00000000 ^P119Temp @!
0 ^P119TempOK @!
0 ^PanelFanM184_ErrorFlag @!
0 ^PanelFanM186_ErrorFlag @!
0.00000000 ^PanelFanMaxCtrl @!
0.00000000 ^PanelTemp @!
0 ^Position @!
0.00000000 ^Preset @!
0 ^RedLink_CR_ErrorFlag @!
0 ^SendData @!
0 ^SubStringLength @!
0 ^TentExhaustFanM306_ErrorFlag @!
0 ^TentExhaustFanM314_ErrorFlag @!
0 ^TentIntakeFanM304_ErrorFlag @!
0 ^TentIntakeFanM312_ErrorFlag @!
0 ^TentStirFanM323_ErrorFlag @!
0 ^TentStirFanM325_ErrorFlag @!
0.00000000 ^TentStirFanMaxCtrl @!
0.00000000 ^TentTemp @!
0 ^TentTempOK @!
0 ^Thermostat_CR_ErrorFlag @!
0.0 ^Timer @!
0 ^Utility_Volt_WatchdogFlag @!
0 ^WriteToLogFailedFlag @!
0 ^x @!
0 ^y @!
0 0 -1 }EcbBitData InitTable
0 0 -1 }EcbStatus InitTable
0 0 -1 }nt03AsIntParameters InitTable
0 0 -1 }nt03HoldingRegAsIntReturnValues InitTable
0 0 -1 }ntEcbCmd InitTable
0 0 -1 }ntRTDdata InitTable
0.00000000 0 -1 }ntRTDtempData InitTable
" "
 *CRLF $MOVE
" "
 *DTdata $MOVE
" "
 *DTmessageReceived $MOVE
" "
 *LF $MOVE
" "
 *sCmd $MOVE
" "
 *sCounter2 $MOVE
" "
 *sCryoTigThermalTimer $MOVE
" "
 *sCurrent $MOVE
" "
 *sCurrentDate $MOVE
" "
 *sCurrentLogCommHandle $MOVE
" "
 *sCurrentLogFile $MOVE
" "
 *sCurrentTime $MOVE
" "
 *sDate $MOVE
" "
 *sDatestamp $MOVE
" "
 *sDay $MOVE
" "
 *sDay1 $MOVE
" "
 *sDT_IP $MOVE
" "
 *sDTerror $MOVE
" "
 *sDTrequest $MOVE
" "
 *sErrorList $MOVE
" "
 *sFanSpd $MOVE
" "
 *sFaultList $MOVE
" "
 *sFTPcmd $MOVE
" "
 *sFWversion $MOVE
" "
 *sGooglePostData $MOVE
" "
 *sGooglePostDataLength $MOVE
" "
 *sGooglePostHeader $MOVE
" "
 *sHeartbeat $MOVE
" "
 *sICDversion $MOVE
" "
 *sIP_hex $MOVE
" "
 *sIP_PAC $MOVE
" "
 *sLog $MOVE
" "
 *sMonth $MOVE
" "
 *sMonth1 $MOVE
" "
 *sNewLog $MOVE
" "
 *sNewLogCommHandle $MOVE
" "
 *sNewLogFile $MOVE
" "
 *sOctet1 $MOVE
" "
 *sOctet2 $MOVE
" "
 *sOctet3 $MOVE
" "
 *sOldDTerror $MOVE
" "
 *sPACuptime $MOVE
" "
 *sPID $MOVE
" "
 *sPidSetpoint $MOVE
" "
 *sPressure $MOVE
" "
 *sRTD1_R0 $MOVE
" "
 *sRTD2_R0 $MOVE
" "
 *sRTD3_R0 $MOVE
" "
 *sRTD4_R0 $MOVE
" "
 *sRTD5_R0 $MOVE
" "
 *sRTD6_R0 $MOVE
" "
 *sRTD7_R0 $MOVE
" "
 *sRTD8_R0 $MOVE
" "
 *sSDcard $MOVE
" "
 *sStirFansSpd $MOVE
" "
 *sSWversion $MOVE
" "
 *Status $MOVE
" "
 *sTentFansSpd $MOVE
" "
 *sTime $MOVE
" "
 *sTimestamp $MOVE
" "
 *sTimestamp1 $MOVE
" "
 *sTimestamp2 $MOVE
" "
 *sTimestamp3 $MOVE
" "
 *sTimestamp4 $MOVE
" "
 *sVar $MOVE
" "
 *sVar1 $MOVE
" "
 *sVoltage $MOVE
" "
 *sYear $MOVE
" "
 *ch_SDcard $MOVE
" "
 *chModbusMaster $MOVE
" tcp:22004"
 *cPort $MOVE
" "
 *DTcommHandle $MOVE
" ftp:docknode05.lco.gtn:21,eng,sbatoo1"
 *FTPcommHandle $MOVE
" tcp:74.125.224.135:80"
 *GoogleCommHandle $MOVE
" file:a,IglooData.txt"
 *LogCommHandle $MOVE
 " "
0 -1 {stDTdata Init$Table
 " "
0 -1 {stHeader Init$Table
 " "
0 -1 {stModbusData Init$Table
 " " *_HSV_INIT_IO $MOVE
;
T: T_INIT_IO
W_INIT_IO
&Powerup START.T DROP
T;
&_INIT_IO ' T_INIT_IO  SETTASK
   : _RUN
   CLEARERRORS
   &_INIT_IO START.T DROP
   ;
: DATESTAMP ." 01/07/19 " ;
: TIMESTAMP ." 19:36:32 " ;
: CRCSTAMP  ." 2CC5E393255F86BBD2083922CD86172B " ;
MAKECHECK
CLEAR.BREAKS

\ ********************** INC File **********************

\ ""DOWNLOAD_COMPRESSION_OFF
